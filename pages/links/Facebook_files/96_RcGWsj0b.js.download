if (self.CavalryLogger) { CavalryLogger.start_js(["qQKW6"]); }

__d("PinnedConversationNubsActionTaken",[],(function a(b,c,d,e,f,g){f.exports={TAB_CLOSED_BY_USER:0,COMMENT_ADDED:1}}),null);
__d("ChannelConnection",["Arbiter","ChannelConstants","ChannelManager","JSLogger","Run","SystemEvents","Visibility","clearTimeout","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g){__p&&__p();var h=c("JSLogger").create("channel_connection"),i=null,j=null,k=null,l=null,m=0;c("ChannelManager").startChannelManager();var n=Object.assign(new(c("Arbiter"))(),{CONNECTED:"chat-connection/connected",RECONNECTING:"chat-connection/reconnecting",SHUTDOWN:"chat-connection/shutdown",MUTE_WARNING:"chat-connection/mute",UNMUTE_WARNING:"chat-connection/unmute"});c("Run").onBeforeUnload(function(){});function o(){if(j){c("clearTimeout")(j);j=null}}function p(){o();h.log("unmute_warning");n.inform(n.UNMUTE_WARNING)}function q(v){o();j=c("setTimeoutAcrossTransitions")(p,v);h.log("mute_warning",{time:v});n.inform(n.MUTE_WARNING)}function r(){if(k){c("clearTimeout")(k);k=null}}function s(v,w){__p&&__p();r();if(v===c("ChannelConstants").ON_ENTER_STATE&&(w.nextState||w.state)==="pull"){if(l!==n.CONNECTED){h.log("connected");var x=!l;l=n.CONNECTED;m=0;n.inform(n.CONNECTED,{init:x})}}else if(v===c("ChannelConstants").ON_ENTER_STATE&&((w.nextState||w.state)==="ping"||!w.nextState&&w.state==="idle"))k=c("setTimeoutAcrossTransitions")(function(){__p&&__p();var y=null;if(!(w.state==="idle"&&!w.nextState))y=w.delay||0;h.log("reconnecting",{delay:y});if(n.disconnected())h.log("reconnecting_ui",{delay:y});l=n.RECONNECTING;w.state==="idle"&&m++;if(m>1)n.inform(n.RECONNECTING,y);else if(!w.nextState&&w.state==="idle")s(v,w)},500);else if(v===c("ChannelConstants").ON_SHUTDOWN){h.log("shutdown",{reason:w.reason});l=n.SHUTDOWN;m=0;n.inform(n.SHUTDOWN,w.reason)}}function t(){if(c("ChannelManager").isShutdown())s(c("ChannelConstants").ON_SHUTDOWN,c("ChannelManager")._shutdownHint);else s(c("ChannelConstants").ON_ENTER_STATE,{state:c("ChannelManager").state,nextState:c("ChannelManager").nextState,delay:0});c("Visibility").addListener(c("Visibility").VISIBLE,n.reconnect)}c("Run").onAfterLoad(t);Object.assign(n,{disconnected:function v(){return l===n.SHUTDOWN||l===n.RECONNECTING&&!j&&m>1},isShutdown:function v(){return l===n.SHUTDOWN},reconnect:function v(w){__p&&__p();if(c("ChannelManager").state==="ping"||c("ChannelManager").state==="pull"||c("ChannelManager").isShutdown())return;h.log("reconnect",{now:w});n.inform(n.RECONNECTING,0);if(!!w){if(i!==null){c("clearTimeout")(i);i=null}c("ChannelManager").enterState("ping!")}else if(!i)i=c("setTimeoutAcrossTransitions")(function(){c("ChannelManager").enterState("ping!");i=null},c("ChannelConstants").CHANNEL_MANUAL_RECONNECT_DEFER_MSEC);c("ChannelManager").resetDelay()},unmuteWarning:p});function u(){c("Arbiter").subscribe([c("ChannelConstants").ON_ENTER_STATE,c("ChannelConstants").ON_SHUTDOWN],s);c("Arbiter").subscribe(c("ChannelConstants").ATTEMPT_RECONNECT,function(){if(n.disconnected())n.reconnect()});c("SystemEvents").subscribe(c("SystemEvents").TIME_TRAVEL,function(){n.reconnect();q(c("ChannelConstants").MUTE_WARNING_TIME_MSEC)});c("Run").onBeforeUnload(r,false)}c("Run").onAfterLoad(u);n.mockAfterLoad=function(){t();u()};c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(v,w){w.channel_connected=!n.disconnected()});f.exports=n}),3);
__d("NubController",["csx","ArbiterMixin","Dock"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(){}Object.assign(i.prototype,c("ArbiterMixin"),{init:function j(k){this.el=k;this.nubButton=k.querySelector(".fbNubButton");this.closeButton=k.querySelector("._2dv8");c("Dock").registerNubController(k,this);if(this.closeButton)this.closeButton.addEventListener("click",this.hide.bind(this));return this},buttonContentChanged:function j(){this.inform("nub/button/content-changed")},flyoutContentChanged:function j(){this.inform("nub/flyout/content-changed")},hide:function j(){c("Dock").hide(this.el)},show:function j(){c("Dock").show(this.el)}});f.exports=i}),null);
__d("BuddyListNub",["csx","cx","fbt","Arbiter","AsyncRequest","AvailableList","BootloadedComponent.react","ChannelConnection","ChatOptions","ChatSidebarActions","ChatSidebarStore","ChatSidebarVisibility","ChatVisibility","CSS","Dock","DOM","Event","intlNumUtils","JSLogger","JSResource","KeyboardShortcuts","Keys","NubController","OrderedFriendsList","Parent","PresencePrivacy","PresenceStatus","PresenceUtil","React","ReactDOM","Run","SidebarType","Style","Toggler","emptyFunction"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l,m=40,n=253,o="285px",p=c("JSLogger").create("buddylist_nub");k=babelHelpers.inherits(q,c("NubController"));l=k&&k.prototype;function q(r,s,t,u){"use strict";__p&&__p();l.constructor.call(this);l.init.call(this,r);this.root=r;this.orderedList=s;this.button=c("DOM").find(r,"a.fbNubButton");this.unreadCount=c("DOM").find(r,"span._5ayx");this.label=c("DOM").find(r,"span.label");this.body=c("DOM").scry(r,"div.fbNubFlyoutBody")[0];this.container=c("Parent").bySelector(r,"._56ox");var v=c("DOM").find(r,"div.fbNubFlyoutTitlebar");c("Toggler").createInstance(v).setSticky(false);c("Toggler").createInstance(r).setSticky(true);if(u)c("Run").onAfterLoad(function(){this.dropdown=c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function w(){},sidebarType:c("SidebarType").BUDDYLIST}),u)}.bind(this));s.subscribeOnce("render",this.flyoutContentChanged.bind(this));c("Run").onAfterLoad(function(){__p&&__p();var w=c("DOM").find(v,"div._4k48");if(w)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),w);var x=c("DOM").find(this.button,"div._1us9");if(x)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarComposeLink.react").__setRef("BuddyListNub"),className:"_3a-4"}),x);var y=c("DOM").find(this.button,"div._1usa");if(y)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarDropdown.react").__setRef("BuddyListNub"),onToggleSidebar:function B(){},sidebarType:c("SidebarType").BUDDYLIST_NUB}),y);var z=c("DOM").find(v,"div._3gl7");if(z)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub")}),z);var A=c("DOM").find(this.button,"div._3gll");if(A)c("ReactDOM").render(c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("span",null),bootloadLoader:c("JSResource")("ChatSidebarGroupCreateButtonReactComponent").__setRef("BuddyListNub"),className:"newGCF"}),A)}.bind(this));s.setScrollContainer(this.body);c("AvailableList").subscribe("buddylist/availability-changed",this._updateCount.bind(this));c("Arbiter").subscribe("chat/connect",function(){return this._handleConnect(true)}.bind(this));c("Arbiter").subscribe("chat/option-changed",function(w,x){if(x.name=="hide_groups")this.onResize();else if(x.name==="hide_buddylist")x.value?this.hide():this.show()}.bind(this));c("ChannelConnection").subscribe(c("ChannelConnection").CONNECTED,function(){return this._updateView()}.bind(this));c("ChannelConnection").subscribe(c("ChannelConnection").SHUTDOWN,function(){return this._updateView()}.bind(this));c("ChannelConnection").subscribe(c("ChannelConnection").RECONNECTING,function(){return this._updateView()}.bind(this));c("ChannelConnection").subscribe([c("ChannelConnection").MUTE_WARNING,c("ChannelConnection").UNMUTE_WARNING],function(){return this._updateView()}.bind(this));this.subscribe("show",this.onShow.bind(this));this.subscribe("hide",this.onHide.bind(this));this.subscribe("resize",this.onResize.bind(this));c("Event").listen(r,"keydown",this._onKeyDown.bind(this));c("Event").listen(this.button,"click",this.onButtonClick.bind(this));c("KeyboardShortcuts").register("q",function(event){if(!this._isOpen){this.onButtonClick();this.show()}event.prevent()}.bind(this),{persistOnTransition:true,shortcutInfo:{displayKeys:["q"],description:j._("Search chat contacts")}});c("Arbiter").subscribe("minisidebar/show",this.hide.bind(this));c("Arbiter").subscribe("sidebar/visibility",function(w,x){if(x)this.hide();else this._onSidebarHide()}.bind(this));c("Style").set(this.body,"min-height",o);c("Arbiter").subscribe("sidebar/typeahead/active",function(w,x){__p&&__p();if(x){this._typeaheadActive=true;c("CSS").hide(this.body.parentNode);this.orderedList.hide();this.onResize()}else{this._typeaheadActive=false;this.onResize();c("CSS").show(this.body.parentNode);this.orderedList.show()}}.bind(this));c("OrderedFriendsList").getList(function(w){if(c("ChatSidebarStore").isEnabled()&&c("ChatSidebarStore").getVisibleType()===c("SidebarType").BUDDYLIST&&!c("ChatOptions").getSetting("hide_buddylist")&&!c("ChannelConnection").disconnected()&&!c("PresencePrivacy").isUserOffline()&&w.length>0)this.show();c("Event").listen(v,"click",function(x){if(c("CSS").matchesSelector(x.target,".titlebarTextWrapper"))this._syncHideBuddylist(true)}.bind(this));this._updateView();p.log("buddylist_initialized")}.bind(this))}q.prototype._handleVisibilityChange=function(){"use strict";this._updateView();if(!c("ChatVisibility").isOnline())this.hide()};q.prototype._updateView=function(r){"use strict";__p&&__p();var s,t;if(!c("ChatVisibility").isOnline())s=j._("{Chat} (Off)",[j._param("Chat",j._("Chat"))]);else if(c("ChannelConnection").disconnected())s=j._("{Chat} (Disconnected)",[j._param("Chat",j._("Chat"))]);else{var u=c("PresenceStatus").getOnlineCount();if(u){var v=c("DOM").create("span",{className:"count"},"("+c("intlNumUtils").formatNumberWithThousandDelimiters(u)+")");s=j._({"*":"{Chat} {number-available}"},[j._param("Chat",j._("Chat")),j._param("number-available",v,[0,u])])}else{s=j._("Chat");t=true}}this._setPresenceIcon();this._setUnread();this._setLabel(s,t);this.buttonContentChanged()};q.prototype._setPresenceIcon=function(){"use strict";c("CSS").conditionClass(this.root,"offline",!c("ChatVisibility").isOnline()||c("ChannelConnection").disconnected())};q.prototype.onButtonClick=function(){"use strict";if(!c("ChatSidebarStore").isInitialized())return true;c("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(r,s){var t=c("ChatSidebarStore").isEnabled();if(!t&&r)c("ChatSidebarActions").enable(c("SidebarType").SIDEBAR);else c("ChatSidebarActions").show(t&&r?c("SidebarType").SIDEBAR:c("SidebarType").BUDDYLIST)})};q.prototype.onHide=function(){"use strict";this._isOpen=false;if(this._buddyListRenderSubscription){this.orderedList.unsubscribe(this._buddyListRenderSubscription);this._buddyListRenderSubscription=null}this._hideBuddyList();c("Arbiter").inform("buddylist/hide")};q.prototype._onKeyDown=function(event){"use strict";var r=c("Event").getKeyCode(event);if(r===c("Keys").ESC&&!c("CSS").hasClass(this.root,"menuOpened")){this.hide();return false}else if(r==c("Keys").RETURN)c("ChatSidebarVisibility").shouldShowSidebarIgnoreEnabled(null,function(s,t){c("ChatSidebarActions").enable(s?c("SidebarType").SIDEBAR:c("SidebarType").BUDDYLIST)})};q.prototype._onSidebarHide=function(event){"use strict";c("OrderedFriendsList").getList(function(r){if(c("ChatSidebarStore").isEnabled()&&!c("ChatOptions").getSetting("hide_buddylist")&&!c("ChannelConnection").disconnected()&&!c("PresencePrivacy").isUserOffline()&&r.lenth>0)this.show();else this.hide()}.bind(this))};q.prototype.onResize=function(){"use strict";var r=!this._typeaheadActive?n:c("Dock").getMaxFlyoutHeight(this.root)-60;c("Arbiter").inform("buddyList/resized",r,c("Arbiter").BEHAVIOR_PERSISTENT);if(this._typeaheadActive)c("Style").set(this.body,"max-height","none");else c("Style").set(this.body,"max-height",o);var s=Math.max(250,r),t=Math.floor(s/m);this.orderedList.setNumTopFriends(t,false,c("SidebarType").BUDDYLIST)};q.prototype._showBuddyList=function(){"use strict";this._buddyListRenderSubscription=this.orderedList.subscribe("render",function(){if(c("Style").get(this.body,"height")!=o)c("Style").set(this.body,"height",o)}.bind(this));this.orderedList.show();p.bump("buddylist_show")};q.prototype._hideBuddyList=function(){"use strict";this.orderedList.hide();p.bump("buddylist_hide")};q.prototype.onShow=function(){"use strict";this._isOpen=true;if(c("ChannelConnection").disconnected()){c("ChannelConnection").reconnect();this._showBuddyList()}else c("ChatVisibility").goOnline(this._showBuddyList.bind(this));this._syncHideBuddylist(false)};q.prototype._setLabel=function(r,s){"use strict";var t=this.label.textContent||this.label.innerText;if(t!==r){var u=this.label.cloneNode(true);c("DOM").setContent(u,r);c("DOM").replace(this.label,u);this.label=u}this.throbber&&c("CSS").conditionShow(this.throbber,!!s)};q.prototype._setUnread=function(r){"use strict";c("CSS").conditionShow(this.unreadCount,!!r)};q.prototype._updateCount=function(){"use strict";this._updateView()};q.prototype._syncHideBuddylist=function(r){"use strict";c("ChatOptions").setSetting("hide_buddylist",r,"buddylist");new(c("AsyncRequest"))("/ajax/chat/settings.php").setHandler(c("emptyFunction")).setErrorHandler(c("emptyFunction")).setData({hide_buddylist:r,window_id:c("PresenceUtil").getSessionID()}).setAllowCrossPageTransition(true).send()};c("Arbiter").subscribe(c("JSLogger").DUMP_EVENT,function(r,s){s.buddylist_visible=c("ChatSidebarStore").getVisibleType()===c("SidebarType").BUDDYLIST});f.exports=q}),null);
__d("isInFocusMode",["WorkFocusModeController"],(function a(b,c,d,e,f,g){var h=c("WorkFocusModeController").WorkFocusMode,i=function i(j){return!!(h&&h.currentViewerInFocusMode(j))};f.exports=i}),null);
__d("ChatUnreadCount",["ChatConfig","ChatDispatcher","ChatUnreadCountActionTypes","MercuryIDs","MercurySingletonProvider","MercuryThreadInformer","MercuryThreads","MercuryUnreadState","isInFocusMode"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();h.getForFBID=function(j){return i.getForFBID(j)};h.get=function(){return i.get()};function h(j){this.$ChatUnreadCount1=j;this.$ChatUnreadCount2=c("MercuryThreadInformer").getForFBID(j);this.$ChatUnreadCount3=c("MercuryThreads").getForFBID(j);this.$ChatUnreadCount4=new Map();this.$ChatUnreadCount5=c("MercuryUnreadState").getForFBID(j);this.setupSubscriptions()}h.prototype.getUnreadCountForUID=function(j){__p&&__p();if(!j)return null;var k=c("MercuryIDs").getThreadIDFromUserID(j);if(!this.$ChatUnreadCount5.getIsThreadUnread(k)&&!c("ChatConfig").get("unread_count_fix")){this.$ChatUnreadCount4["delete"](j);return 0}var l=this.$ChatUnreadCount3.getOrFetch(k),m=l&&l.unread_count;if(!m&&c("ChatConfig").get("unread_count_fix"))this.$ChatUnreadCount4["delete"](j);else this.$ChatUnreadCount4.set(j,m);if(c("isInFocusMode")(k))return 0;return m};h.prototype.setupSubscriptions=function(){__p&&__p();this.$ChatUnreadCount2.subscribe("threads-updated",function(j,k){var l=Object.keys(k).some(function(m){var n=c("MercuryIDs").getUserIDFromThreadID(m);if(!n)return false;var o=this.getUnreadCountForUID(n),p=this.$ChatUnreadCount4.get(n)||0;return o!==p}.bind(this));if(l)c("ChatDispatcher").dispatch({type:c("ChatUnreadCountActionTypes").COUNT_UPDATED})}.bind(this));this.$ChatUnreadCount2.subscribe("unread-updated",function(){return c("ChatDispatcher").dispatch({type:c("ChatUnreadCountActionTypes").COUNT_UPDATED})})};var i=new(c("MercurySingletonProvider"))(h);f.exports=h}),null);
__d("NotificationBeeperConst",["keyMirror"],(function a(b,c,d,e,f,g){var h={IDLE_DELAY:1e4,ACTIVE_DELAY_LONG:4e3,FADE_OUT_LENGTH:1500,BeepStates:c("keyMirror")({PENDING:true,RENDERED:true,READY_TO_HIDE:true,FADING_OUT:true})};f.exports=h}),null);
__d("NotificationBeeperItemCloseButton.react",["cx","fbt","React","XUIAbstractGlyphButton.react"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;j=babelHelpers.inherits(l,c("React").Component);k=j&&j.prototype;l.prototype.render=function(){"use strict";var m=i._("Close");return c("React").createElement(c("XUIAbstractGlyphButton.react"),babelHelpers["extends"]({},this.props,{className:"_3soc",title:m,label:m,labelIsHidden:true}))};function l(){"use strict";j.apply(this,arguments)}f.exports=l}),null);
__d("NotificationURI",["BusinessURI.brands","URI","VideoPermalinkURI","isFacebookURI"],(function a(b,c,d,e,f,g){__p&&__p();var h={localize:function i(j){try{j=c("BusinessURI.brands")(j)}catch(k){return j.toString()}var l=j.getSubdomain();return j.getUnqualifiedURI().getQualifiedURI().setSubdomain(l).toString()},snowliftable:function i(j){if(!j)return false;var k=new(c("URI"))(j),l=k.getQueryData();return c("isFacebookURI")(k)&&(c("VideoPermalinkURI").isValid(k)||"fbid"in l)},isVaultSetURI:function i(j){return this._areEquals(j,"/ajax/vault/sharer_preview.php")},isAlbumDraftRecoveryDialogURI:function i(j){return this._areEquals(j,"/ajax/photos/upload/overlay/")},isQuicksilverURI:function i(j){return this._areEquals(j,"/games/quicksilver/spotlight/")},isDirectURI:function i(j){return this._startsWith(j,"/direct/")},isIGAccountCreationURI:function i(j){return this._areEquals(j,"/ads/growth/aymt/instagram/account-creation-dialog/")},_areEquals:function i(j,k){if(!j)return false;var l=new(c("URI"))(j);return c("isFacebookURI")(l)&&l.getPath()===k},_startsWith:function i(j,k){if(!j)return false;var l=new(c("URI"))(j);return c("isFacebookURI")(l)&&l.getPath().startsWith(k)}};f.exports=h}),null);
__d("XLiveVideoLoadController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/live/video/load/",{video_id:{type:"FBID",required:true}})}),null);
__d("NotificationListRendererUtils",["AsyncRequest","Bootloader","NotificationURI","PageTransitions","URI","VideoChainingCaller","XLiveVideoLoadController","idx"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=10;function i(event,l){c("Bootloader").loadModules(["FBStoriesLiveNotificationHandler"],function(m){m.renderLiveStory(l)},"NotificationListRendererUtils")}function j(event,l,m){c("Bootloader").loadModules(["TahoeController"],function(n){var o,p=c("NotificationURI").localize(new(c("URI"))(m.url)),q=l.video_channel_caller;n.openFromVideoLink(new(c("URI"))(p),{channelID:l.video_channel_id,caller:q?(o=c("VideoChainingCaller"))!=null?o[q]:o:null})},"NotificationListRendererUtils")}var k={openNotification:function l(event,m){__p&&__p();var n=m.renderer_data;if(n==null)return;if(!k.isStoryOnlyLiveVideoNotification(m)&&(event.metaKey||event.ctrlKey||event.button===1))return;if(n.__typename==="LiveVideoNotificationRendererData"){event.preventDefault();var o=c("XLiveVideoLoadController").getURIBuilder().setFBID("video_id",n.video_id).getURI(),p=new(c("AsyncRequest"))(o).setHandler(function(q){if(q.payload)k.openNotificationInSurface(event,m);else c("PageTransitions").go(m.url)});p.send()}},openNotificationInSurface:function l(event,m){var n=m.renderer_data;if(n==null)return;if(n.bucket_data)i(event,n);else if(n.can_render_in_tahoe)j(event,n,m)},isStoryOnlyLiveVideoNotification:function l(m){var n=m.renderer_data;if(n==null)return false;return n.__typename==="LiveVideoNotificationRendererData"&&!!n.bucket_data}};f.exports=k}),null);
__d("RelationshipDelightTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$RelationshipDelightTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$RelationshipDelightTypedLogger1,c("Banzai").VITAL)};h.prototype.logImmediately=function(){c("GeneratedLoggerUtils").log("logger:RelationshipDelightLoggerConfig",this.$RelationshipDelightTypedLogger1,{signal:true})};h.prototype.clear=function(){this.$RelationshipDelightTypedLogger1={};return this};h.prototype.getData=function(){return babelHelpers["extends"]({},this.$RelationshipDelightTypedLogger1)};h.prototype.updateData=function(j){this.$RelationshipDelightTypedLogger1=babelHelpers["extends"]({},this.$RelationshipDelightTypedLogger1,j);return this};h.prototype.setAlertID=function(j){this.$RelationshipDelightTypedLogger1.alert_id=j;return this};h.prototype.setEvent=function(j){this.$RelationshipDelightTypedLogger1.event=j;return this};h.prototype.setMetadata=function(j){this.$RelationshipDelightTypedLogger1.metadata=j;return this};h.prototype.setVC=function(j){this.$RelationshipDelightTypedLogger1.vc=j;return this};var i={alert_id:true,event:true,metadata:true,vc:true};f.exports=h}),null);
__d("RelationshipDelightUtils",["NotificationRelationshipDelightsConfig","QE2Logger","RelationshipDelightTypedLogger"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={};function i(n){var o=n.eligible_buckets;return!!o&&o.indexOf("SO_NOTIFICATIONS")!==-1}function j(){c("QE2Logger").logExposureForUser(c("NotificationRelationshipDelightsConfig").universeName)}function k(n){var o=c("NotificationRelationshipDelightsConfig").shouldDecorateNotificationWithHearts,p=c("NotificationRelationshipDelightsConfig").shouldLogExposureForNotification;if(i(n)===false)return false;if(p)j();return o===true}function l(n,event,o){var p=event+"-"+n;if(h[p])return;h[p]=true;var q=new(c("RelationshipDelightTypedLogger"))().setEvent(event).setAlertID(n);if(o)q.setMetadata(JSON.stringify(o));q.log()}var m={shouldHeartBadge:function n(o){var p=c("NotificationRelationshipDelightsConfig").shouldDecorateBadgeWithHearts,q=c("NotificationRelationshipDelightsConfig").shouldLogExposureForBadge;if(i(o)===false)return false;if(q)j();return p===true},shouldHeartBeeper:k,shouldHeartNotification:k,logNotificationAnimation:function n(o,p,q){l(o,"notification_animated",{animation:p,rowIndex:q})},logBeeperAnimation:function n(o){l(o,"beeper_animated")},logBadgeAnimation:function n(o){l(o,"badge_animated")}};f.exports=m}),null);
__d("NotificationBeeperItemContents.react",["cx","Animation","AsyncRequest","BootloadedComponent.react","Bootloader","FBProfilePhotoShadow.react","Image.react","ImageBlock.react","JSResource","NotificationBeeperItemCloseButton.react","NotificationInterpolator","NotificationListRendererUtils","NotificationURI","NotificationUserActions","React","ReactDOM","RelationshipDelightUtils","TextWithEntities.react","Timestamp.react","URI"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j;i=babelHelpers.inherits(k,c("React").Component);j=i&&i.prototype;function k(){__p&&__p();var l,m;"use strict";for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return m=(l=j.constructor).call.apply(l,[this].concat(o)),this.isLiveVideo=null,this.$NotificationBeeperItemContents2=function(q){__p&&__p();this.$NotificationBeeperItemContents1();this.props.onHide();if(q.button===1||q.altKey||q.ctrlKey||q.metaKey||q.shiftKey)return;var r=this.props.notification;c("NotificationListRendererUtils").openNotification(q,r);if(q.isDefaultPrevented()===true)return;var s=r.primerAttributes;if(s&&(s.rel==="async"||s.rel==="async-post")){var t=new(c("AsyncRequest"))(s.ajaxify||r.url);if(s.rel==="async-post")t.setMethod("POST");t.send();q.preventDefault()}else if(s&&s.rel==="theater"){q.persist();c("Bootloader").loadModules(["PhotoSnowlift"],function(u){u.bootstrap(s.ajaxify||r.url,q.currentTarget)},"NotificationBeeperItemContents.react");q.preventDefault()}else if(s&&(s.rel==="dialog"||s.rel==="dialog-post")){c("Bootloader").loadModules(["AsyncDialog"],function(u){u.bootstrap(s.ajaxify||r.url,q.currentTarget,"dialog")},"NotificationBeeperItemContents.react");q.preventDefault()}}.bind(this),this.$NotificationBeeperItemContents3=function(){this.$NotificationBeeperItemContents1();this.props.onHide()}.bind(this),m}k.prototype.$NotificationBeeperItemContents1=function(){"use strict";c("NotificationUserActions").markNotificationsAsRead([this.props.notification.alert_id])};k.prototype.$NotificationBeeperItemContents4=function(){"use strict";new(c("Animation"))(c("ReactDOM").findDOMNode(this.refs.inner)).from("opacity","0").to("opacity","1").duration(200).go()};k.prototype.$NotificationBeeperItemContents5=function(){"use strict";var l=this.$NotificationBeeperItemContents6(),m=JSON.parse(l);return m.content_id};k.prototype.$NotificationBeeperItemContents7=function(){"use strict";if(this.isLiveVideo===null){var l=this.$NotificationBeeperItemContents6();this.isLiveVideo=l.indexOf("live_video")!==-1}return!!this.isLiveVideo};k.prototype.$NotificationBeeperItemContents6=function(){"use strict";return this.props.notification.tracking||"{}"};k.prototype.$NotificationBeeperItemContents8=function(){"use strict";var l=this.props.notification,m=c("RelationshipDelightUtils").shouldHeartBeeper(l);if(!m)return null;c("RelationshipDelightUtils").logBeeperAnimation(l.alert_id);return c("React").createElement("div",{className:"_5_xp"},c("React").createElement(c("BootloadedComponent.react"),{bootloadPlaceholder:c("React").createElement("div",null),bootloadLoader:c("JSResource")("RelationshipDelightsActorAnimation.react").__setRef("NotificationBeeperItemContents.react")}))};k.prototype.componentDidMount=function(){"use strict";this.props.onReadyToHide(this.props.notification.alert_id);if(this.$NotificationBeeperItemContents7())c("Bootloader").loadModules(["VideoPlayerMetaData","PhotoSnowliftVideoNode"],function(l,m){var n=this.$NotificationBeeperItemContents5();if(n)l.genVideoData(n)}.bind(this),"NotificationBeeperItemContents.react")};k.prototype.componentDidUpdate=function(l){"use strict";if(l.notification.alert_id!==this.props.notification.alert_id||l.notification.creation_time!==this.props.notification.creation_time){this.$NotificationBeeperItemContents4();this.props.onReadyToHide(this.props.notification.alert_id)}};k.prototype.render=function(){"use strict";var l=this.props.notification,m=l.thumbnail?l.thumbnail.uri:null,n=l.icon?l.icon.uri:null,o=c("NotificationURI").localize(new(c("URI"))(l.url));return c("React").createElement("div",{ref:"inner",className:this.props.className},c("React").createElement(c("NotificationBeeperItemCloseButton.react"),{onClick:this.$NotificationBeeperItemContents3}),c("React").createElement("a",{href:o,onClick:this.$NotificationBeeperItemContents2,className:"_3soi"},c("React").createElement(c("ImageBlock.react"),{className:"_3soj",spacing:"medium"},c("React").createElement(c("FBProfilePhotoShadow.react"),{className:"_2yt7"},c("React").createElement(c("Image.react"),{src:m,className:"_3sok"+(!m?" hidden_elem":"")})),c("React").createElement("div",{className:"_3sol"},c("React").createElement(c("TextWithEntities.react"),{renderEmoticons:true,renderEmoji:true,interpolator:c("NotificationInterpolator"),ranges:l.title.ranges,aggregatedranges:l.title.aggregated_ranges,text:l.title.text}),c("React").createElement(c("ImageBlock.react"),{className:"_3som"},c("React").createElement(c("Image.react"),{className:"_1x8t"+(!n?" hidden_elem":""),src:n}),c("React").createElement(c("Timestamp.react"),{time:l.timestamp.time,text:l.timestamp.text,verbose:l.timestamp.verbose})))),this.$NotificationBeeperItemContents8()))};f.exports=k}),null);
__d("NotificationBeeperItem.react",["cx","CSSFade","NotificationBeeperConst","NotificationBeeperItemContents.react","NotificationBeeperItemRenderersList","React","ReactDOM","Style","setTimeoutAcrossTransitions"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("NotificationBeeperConst").FADE_OUT_LENGTH;i=babelHelpers.inherits(l,c("React").Component);j=i&&i.prototype;function l(){var m,n;"use strict";for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return n=(m=j.constructor).call.apply(m,[this].concat(p)),this.state={encounteredException:false,fadedIn:false,hidden:false},this.$NotificationBeeperItem3=function(){this.setState({hidden:true})}.bind(this),n}l.prototype.componentDidCatch=function(){"use strict";this.props.onReadyToHide(this.props.notification.alert_id);this.setState(function(m){return babelHelpers["extends"]({},m,{encounteredException:true})})};l.prototype.componentDidMount=function(){"use strict";c("setTimeoutAcrossTransitions")(function(){this.setState({fadedIn:true})}.bind(this),50);this.props.onInserted(this.props.notification.alert_id)};l.prototype.componentWillUnmount=function(){"use strict";if(this.$NotificationBeeperItem1)this.$NotificationBeeperItem1.cancel()};l.prototype.render=function(){"use strict";if(this.state.encounteredException)return null;var m=this.props.notification,n=m.renderer_data,o=m.tracking,p=this.$NotificationBeeperItem4(n);return c("React").createElement("li",{className:this.state.hidden?"hidden_elem":"",ref:function(q){return this.$NotificationBeeperItem2=q}.bind(this),"data-gt":o},c("React").createElement(p,{className:"_3sod"+(this.state.fadedIn?" _3soe":""),notification:this.props.notification,onHide:this.$NotificationBeeperItem3,onReadyToHide:this.props.onReadyToHide,onPreventHide:this.props.onPreventHide}))};l.prototype.componentDidUpdate=function(m,n,o){"use strict";__p&&__p();if(!this.$NotificationBeeperItem2)return;var p=c("ReactDOM").findDOMNode(this.$NotificationBeeperItem2);if(!p)return;if(this.props.fadingOut){this.$NotificationBeeperItem1=c("CSSFade").hide(p,{callback:this.$NotificationBeeperItem3,duration:k});p.style.transitionDuration="0ms"}else{if(this.$NotificationBeeperItem1){this.$NotificationBeeperItem1.cancel();this.$NotificationBeeperItem1=undefined}c("Style").set(p,"opacity","1")}};l.prototype.$NotificationBeeperItem4=function(m){"use strict";if(m&&m.__typename==="LiveVideoNotificationRendererData"&&m.video_id==null)return c("NotificationBeeperItemContents.react");return c("NotificationBeeperItemRenderersList")[m&&m.__typename]||c("NotificationBeeperItemContents.react")};f.exports=l}),null);
__d("NotificationImpressions",["AsyncSignal","NotificationTokens","URI"],(function a(b,c,d,e,f,g){var h="/ajax/notifications/impression.php";function i(j,k){var l={ref:k};c("NotificationTokens").untokenizeIDs(j).forEach(function(m,n){l["alert_ids["+n+"]"]=m});new(c("AsyncSignal"))(new(c("URI"))(h).getQualifiedURI().toString(),l).send()}f.exports={log:i}}),null);
__d("NotificationSound",["Sound"],(function a(b,c,d,e,f,g){__p&&__p();var h=5e3;c("Sound").init(["audio/mpeg"]);function i(j){this._soundPath=j;this._lastPlayed=0}Object.assign(i.prototype,{play:function j(k){if(!this._soundPath)return;var l=Date.now();if(l-this._lastPlayed<h)return;this._lastPlayed=l;c("Sound").playOnlyIfImmediate(this._soundPath,k)}});f.exports=i}),null);
__d("NotificationBeeper.react",["cx","Arbiter","ChannelConstants","FacebookWebNotificationsSubscription","NotificationBeeperConst","NotificationBeeperItem.react","NotificationConstants","NotificationImpressions","NotificationSound","NotificationUpdates","NotificationUserActions","NotifTestIDs","React","SubscriptionsHandler","WorkFocusModeController","clearTimeout","setTimeoutAcrossTransitions","shield"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=c("WorkFocusModeController").WorkFocusMode,l=c("NotificationBeeperConst").ACTIVE_DELAY_LONG,m=c("NotificationBeeperConst").BeepStates,n=c("NotificationBeeperConst").FADE_OUT_LENGTH,o=c("NotificationBeeperConst").IDLE_DELAY,p="beeper",q=c("NotificationConstants").PayloadSourceType,r=q.CLIENT,s=q.OTHER_APPLICATION;i=babelHelpers.inherits(t,c("React").Component);j=i&&i.prototype;function t(){__p&&__p();var u,v;"use strict";for(var w=arguments.length,x=Array(w),y=0;y<w;y++)x[y]=arguments[y];return v=(u=j.constructor).call.apply(u,[this].concat(x)),this.state={beeps:{},fading:false,hovering:false,soundEnabled:this.props.soundEnabled},this.onMouseEnter=function(){this.$NotificationBeeper2&&c("clearTimeout")(this.$NotificationBeeper2);var z=[],A=this.state.beeps;Object.keys(A).forEach(function(B){if(A[B].state!=m.PENDING)z.push(B);else A[B].state=m.RENDERED});c("NotificationUserActions").markNotificationsAsSeen(z);this.setState({hovering:true,fading:false,beeps:A})}.bind(this),this.onMouseLeave=function(){this.$NotificationBeeper5(l);this.setState({hovering:false})}.bind(this),this.$NotificationBeeper6=function(z){if(!this.state.hovering)this.$NotificationBeeper5();if(this.state.soundEnabled&&this.state.beeps[z].shouldPlaySound){if(!this.$NotificationBeeper3)this.$NotificationBeeper3=new(c("NotificationSound"))(this.props.soundPath);this.$NotificationBeeper3.play(z)}if(this.props.shouldLogImpressions)c("NotificationImpressions").log([z],p)}.bind(this),this.onReadyToHide=function(z,A){this.setState(function(B){var C=babelHelpers["extends"]({},B.beeps);C[z]=babelHelpers["extends"]({},C[z],{state:m.READY_TO_HIDE});return babelHelpers["extends"]({},B,{beeps:C})});if(!this.$NotificationBeeper2)this.$NotificationBeeper5(A)}.bind(this),this.$NotificationBeeper8=function(z){this.setState(function(A){var B=babelHelpers["extends"]({},A.beeps);B[z]=babelHelpers["extends"]({},B[z],{state:m.RENDERED});return babelHelpers["extends"]({},A,{beeps:B})})}.bind(this),this.$NotificationBeeper7=function(){this.$NotificationBeeper2=null;this.setState(function(z){var A=babelHelpers["extends"]({},z.beeps);Object.keys(A).forEach(function(B){if(A[B].state==m.READY_TO_HIDE)A[B]=babelHelpers["extends"]({},A[B],{state:m.FADING_OUT})});return babelHelpers["extends"]({},z,{beeps:A,fading:true})});c("setTimeoutAcrossTransitions")(c("shield")(this.$NotificationBeeper9,this),n)}.bind(this),this.$NotificationBeeper9=function(){__p&&__p();if(!this.state.fading)return;this.setState(function(z){var A=babelHelpers["extends"]({},z.beeps);Object.keys(A).forEach(function(B){if(A[B].state==m.FADING_OUT)delete A[B]});return babelHelpers["extends"]({},z,{beeps:A,fading:false})});c("setTimeoutAcrossTransitions")(function(){this.setState(function(z){var A=babelHelpers["extends"]({},z.beeps);Object.keys(A).forEach(function(B){if(A[B].state==m.PENDING)A[B]=babelHelpers["extends"]({},A[B],{state:m.RENDERED})});return babelHelpers["extends"]({},z,{beeps:A})})}.bind(this))}.bind(this),v}t.prototype.UNSAFE_componentWillMount=function(){"use strict";__p&&__p();var u=new(c("SubscriptionsHandler"))();u.addSubscriptions(c("NotificationUpdates").subscribe("update-notifications",function(v,w){if(w.payloadsource===s||w.payloadsource===r){if(k&&k.currentViewerInFocusMode())return;var x=w.nodes;if(x&&x.length)this.handleBeepChanges(this.$NotificationBeeper4(x))}}.bind(this)),c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("notif_sound_pref_changed"),function(v,w){this.setState({soundEnabled:w.obj.enabled})}.bind(this)));u.addSubscriptions(c("FacebookWebNotificationsSubscription").subscribe({event:"NEW_BEEPER",callback:function(v){var w=v.notification,x=v.should_play_sound;if(k&&k.currentViewerInFocusMode())return;if(w!==null){var y;this.handleBeepChanges((y={},y[w.alert_id]={notification:w,shouldPlaySound:x},y))}}.bind(this)}));this.$NotificationBeeper1=u;c("Arbiter").inform("NotificationBeeper/mounted",null,c("Arbiter").BEHAVIOR_PERSISTENT)};t.prototype.componentWillUnmount=function(){"use strict";if(this.$NotificationBeeper1)this.$NotificationBeeper1.release();this.$NotificationBeeper1=null};t.prototype.$NotificationBeeper5=function(u){"use strict";this.$NotificationBeeper2&&c("clearTimeout")(this.$NotificationBeeper2);this.$NotificationBeeper2=c("setTimeoutAcrossTransitions")(c("shield")(this.$NotificationBeeper7,this),u==null?o:u)};t.prototype.handleBeepChanges=function(u){"use strict";__p&&__p();var v=this.state.fading?m.PENDING:m.RENDERED,w=false,x=babelHelpers["extends"]({},this.state.beeps);Object.keys(u).reverse().forEach(function(y){var z=u[y],A=x[y];if(!A||A.notification.alert_id!==z.notification.alert_id||A.notification.creation_time!==z.notification.creation_time){if(A){w=true;delete x[y]}x[y]=babelHelpers["extends"]({},z,{state:v})}});if(w)this.$NotificationBeeper5();this.setState({beeps:x})};t.prototype.render=function(){"use strict";var u=this.state.beeps,v=[];Object.keys(u).reverse().forEach(function(y){var z=u[y];if(z.state==m.PENDING)return;v.push(c("React").createElement(c("NotificationBeeperItem.react"),{key:y,fadingOut:this.state.fading&&z.state==m.FADING_OUT,notification:z.notification,onInserted:this.$NotificationBeeper6,onReadyToHide:this.onReadyToHide,onPreventHide:this.$NotificationBeeper8}))}.bind(this),this);var w=v.length>0,x=(!w?"hidden_elem":"")+" _50d1";return c("React").createElement("ul",{ref:"container",className:x,"data-gt":this.props.tracking,"data-testid":c("NotifTestIDs").BEEPER_LIST,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},v)};t.prototype.$NotificationBeeper4=function(u){"use strict";return u.reduce(function(v,w){v[w.alert_id]={notification:w,shouldPlaySound:false};return v},{})};f.exports=t}),null);
__d("NotificationBeeperContainer",["NotificationBeeper.react","React","ReactDOM"],(function a(b,c,d,e,f,g){var h={renderBeeper:function i(j,k){c("ReactDOM").render(c("React").createElement(c("NotificationBeeper.react"),j),k)}};f.exports=h}),null);
__d("LiveVideoBeeperItemContents.react",["BootloadOnRender.react","JSResource","LazyComponent.react","React"],(function a(b,c,d,e,f,g){"use strict";var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.prototype.render=function(){return c("React").createElement(c("BootloadOnRender.react"),{loader:c("JSResource")("LiveVideoBeeperItemContentsImpl.react").__setRef("LiveVideoBeeperItemContents.react"),placeholder:c("React").createElement("div",null),component:c("React").createElement(c("LazyComponent.react"),babelHelpers["extends"]({},this.props,{ref:"itemContents"}))})};function j(){h.apply(this,arguments)}f.exports=j}),null);
__d("ConversationNubAddTabSource",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({NOTIFICATION:"notification",PAGE_REFRESH:"page_refresh",USER_PIN:"user_pin",UNSEEN_NOTIFICATION:"unseen_notification",UNKNOWN:"unknown"})}),null);
__d("ConversationNubTabStateListStorage",[],(function a(b,c,d,e,f,g){"use strict";function h(){this.$ConversationNubTabStateListStorage1=[]}h.prototype.modify=function(i){this.$ConversationNubTabStateListStorage1=i(this.$ConversationNubTabStateListStorage1)};h.prototype.getData=function(){return this.$ConversationNubTabStateListStorage1};f.exports=h}),null);
__d("differenceSets",["filterSet"],(function a(b,c,d,e,f,g){"use strict";function h(i){for(var j=arguments.length,k=Array(j>1?j-1:0),l=1;l<j;l++)k[l-1]=arguments[l];return c("filterSet")(i,function(m){return!k.some(function(n){return n.has(m)})})}f.exports=h}),null);
__d("ConversationNubTabStateList",["invariant","ConversationNubTabStateListStorage","differenceSets"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();function i(){this.$ConversationNubTabStateList2=new Set();this.$ConversationNubTabStateList1=new(c("ConversationNubTabStateListStorage"))()}i.prototype.modifyTabState=function(j,k){this.modifyTabs(function(l){var m=l.findIndex(function(n){return n.tabID===j});m!==-1||h(0);k(l[m]);return l})};i.prototype.$ConversationNubTabStateList3=function(j){return new Set(j.map(function(k){return k.tabID}))};i.prototype.modifyTabs=function(j){try{this.$ConversationNubTabStateList1.modify(function(k){var l=this.$ConversationNubTabStateList3(k),m=j(k),n=this.$ConversationNubTabStateList3(m);this.$ConversationNubTabStateList2=c("differenceSets")(l,n);return m}.bind(this))}finally{this.$ConversationNubTabStateList2=new Set()}};i.prototype.getTabs=function(){return this.$ConversationNubTabStateList1.getData()};i.prototype.getTabState=function(j){var k=this.getTabStateIfExists(j);k||h(0);return k};i.prototype.getTabStateIfExists=function(j){return this.getTabs().find(function(k){return k.tabID===j})};i.prototype.push=function(){for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];this.modifyTabs(function(m){k.forEach(function(n){if(m.find(function(o){return o.tabID===n.tabID}))h(0);else m.push(n)});return m})};i.prototype.remove=function(j){this.modifyTabs(function(k){var l=k.findIndex(function(m){return m.tabID===j});if(l!==-1)k.splice(l,1);return k})};f.exports=i}),null);
__d("ConversationNubTabState",["invariant","ConversationNubTabStateList"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=12;function j(){this.$ConversationNubTabStateClass1=Object.create(null);this.$ConversationNubTabStateClass2=new(c("ConversationNubTabStateList"))();this.$ConversationNubTabStateClass3=Infinity}j.prototype.anyTabHasFocus=function(){return this.getUnsortedLoadedTabs().some(function(k){return k.getIsFocused()})};j.prototype.anyTabHasText=function(){return this.getUnsortedLoadedTabs().some(function(k){return k.getHasText()})};j.prototype.getTabState=function(k){return this.$ConversationNubTabStateClass2.getTabState(k)};j.prototype.getTabStateIfExists=function(k){return this.$ConversationNubTabStateClass2.getTabStateIfExists(k)};j.prototype.getUnloadedTabs=function(){var k=this.$ConversationNubTabStateClass2.getTabs().filter(function(l){return!this.getLoadedTab(l.tabID)}.bind(this));return k};j.prototype.setMaxDockTabs=function(k){this.$ConversationNubTabStateClass3=k};j.prototype.getNumDockTabs=function(){var k=this.$ConversationNubTabStateClass3,l=this.getTotalTabCount();return Math.min(k,l)};j.prototype.getNumMenuTabs=function(){return this.getTotalTabCount()-this.getNumDockTabs()};j.prototype.addTabState=function(k){this.$ConversationNubTabStateClass2.push(k)};j.prototype.addLoadedTab=function(k,l){var m=this.getTabState(k);if(!m)return;var n=this.getLoadedTab(k);if(n)return;this.$ConversationNubTabStateClass1[k]=l;this.$ConversationNubTabStateClass4()};j.prototype.getLoadedTab=function(k){return this.$ConversationNubTabStateClass1[k]};j.prototype.getLoadedTabByFeedbackTarget=function(k){return this.getLoadedTabs().find(function(l){return l.getPersistentState().ftID===k})};j.prototype.isTabInDock=function(k){var l=this.getLoadedTab(k);if(!l)return false;var m=this.$ConversationNubTabStateClass5(l);return 0<=m&&m<this.getNumDockTabs()};j.prototype.clearTabNotifications=function(k){this.$ConversationNubTabStateClass2.modifyTabState(k,function(l){l.unseenCommentsSinceLastCleared={};l.hasFakeInitBadge=false;l.badgeCount=0;l.isBlinkingUnread=false})};j.prototype.deleteTab=function(k){var l=this.getLoadedTab(k);if(l){delete this.$ConversationNubTabStateClass1[k];l.destroy()}this.$ConversationNubTabStateClass2.remove(k);return Boolean(l)};j.prototype.deleteAllTabs=function(){this.getUnsortedLoadedTabs().forEach(function(k){return this.deleteTab(k.getTabID())}.bind(this))};j.prototype.modifyTabState=function(k,l){return this.$ConversationNubTabStateClass2.modifyTabState(k,l)};j.prototype.moveTabToDockLeft=function(k){__p&&__p();var l=this.getLoadedTab(k);if(!l)return;this.$ConversationNubTabStateClass2.modifyTabs(function(m){__p&&__p();var n=m.findIndex(function(l){return l.tabID===k});n!==-1||h(0);var o=m[n],p=this.$ConversationNubTabStateClass5(l),q=this.getLoadedTabs().length,r=this.getNumDockTabs();if(p<0||q===0)return m;else if(r===0){if(p!==0){m.splice(n,1);m.unshift(o)}return m}var s=r-1;if(p===s)return m;m.splice(n,1);if(p<s)s-=1;var t=this.getLoadedTabs()[s],u=this.getTabState(t.getTabID());u||h(0);var v=m.findIndex(function(l){return l.tabID===u.tabID});m.splice(v,0,o);return m}.bind(this))};j.prototype.getLoadedTabs=function(){var k=this.$ConversationNubTabStateClass2.getTabs().map(function(l){return this.getLoadedTab(l.tabID)}.bind(this)).filter(Boolean);return k};j.prototype.getUnsortedLoadedTabs=function(){var k=Object.values(this.$ConversationNubTabStateClass1);return k};j.prototype.getTotalTabCount=function(){return this.getUnsortedLoadedTabs().length};j.prototype.getTabsForDockOldestFirst=function(){return this.getLoadedTabs().slice(0,this.getNumDockTabs())};j.prototype.getTabsForDockNewestFirst=function(){return this.getTabsForDockOldestFirst().slice().reverse()};j.prototype.getTabsForMenuOldestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs())};j.prototype.getTabsForMenuNewestFirst=function(){return this.getLoadedTabs().slice(this.getNumDockTabs()).reverse()};j.prototype.$ConversationNubTabStateClass4=function(){var k=this.getLoadedTabs().length;if(k>i){var l=k-i,m=this.getTabsForMenuOldestFirst().slice(0,l);m.map(function(n){return n.getTabID()}).forEach(function(n){return this.deleteTab(n)}.bind(this))}};j.prototype.$ConversationNubTabStateClass5=function(k){return this.getLoadedTabs().indexOf(k)};f.exports=new j()}),null);
__d("ConversationNubAddCommentSubscription",["Arbiter","ConversationNubTabState","UFIUIEvents"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){return c("Arbiter").subscribe(c("UFIUIEvents").Comment,function(j,k){var l=k.ft_id,m=k.form;if(!l||!m)return;var n=c("ConversationNubTabState").getLoadedTabByFeedbackTarget(l);if(n&&n.isFormForThisUFI(m))i(n,l)})}f.exports={subscribe:h}}),null);
__d("ConversationNub",["csx","cx","Arbiter","ConversationNubHeader","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","CSS","DOM","EventListener","NotificationUserActions","SubscriptionsHandler","UFIComposerIsTypingStore","URI","containsNode","debounce","guid"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("ConversationNubTabsUpdateEventController").minimizeAndInformTabUpdate,k=c("ConversationNubTabsUpdateEventController").popOutAndInformTabUpdate,l=c("ConversationNubTabState"),m=10,n=500,o=100;p.createDefaultState=function(q,r,s,t,u,v){return{tabID:q,permalinkURI:r?new(c("URI"))(r):null,ftID:s,notifAlertID:t,notificationType:u,title:v,keepAtBottom:false,isTabRaised:false,isBlinkingUnread:false,badgeCount:0,allSeenNewComments:{},unseenCommentsSinceLastCleared:{},hasFakeInitBadge:false}};function p(q,r,s,t){__p&&__p();var u=arguments.length<=4||arguments[4]===undefined?false:arguments[4],v=arguments.length<=5||arguments[5]===undefined?false:arguments[5];this.$ConversationNub13=false;this.$ConversationNub14=false;this.$ConversationNub1=q;this.$ConversationNub12=r;this.$ConversationNub5=c("guid")();this.$ConversationNub7=null;this.$ConversationNub8=false;this.$ConversationNub9=null;this.$ConversationNub10=u;this.$ConversationNub11=v;this.$ConversationNub15=t;this.$ConversationNub6=new(c("SubscriptionsHandler"))();this.$ConversationNub16();this.$ConversationNub17();if(s!=null)l.modifyTabState(this.$ConversationNub12,function(w){if(s)w.hasFakeInitBadge=false;else{w.hasFakeInitBadge=true;this.$ConversationNub18(1);this.$ConversationNub19(true)}}.bind(this));this.$ConversationNub20()}p.prototype.$ConversationNub20=function(){this.$ConversationNub21();this.$ConversationNub22();c("ConversationNubUtils").informShouldRecheckTabVisibility(this);this.forceReflow()};p.prototype.getPersistentState=function(){return l.getTabState(this.$ConversationNub12)};p.prototype.getPersistentStateIfExists=function(){return l.getTabStateIfExists(this.$ConversationNub12)};p.prototype.$ConversationNub16=function(){__p&&__p();var q=this.$ConversationNub23();if(q){this.$ConversationNub6.addSubscriptions(c("EventListener").listen(q,"click",this.$ConversationNub24.bind(this)),c("EventListener").listen(q,"mouseenter",this.$ConversationNub25.bind(this)),c("EventListener").listen(q,"mouseleave",this.$ConversationNub26.bind(this)));var r=c("ConversationNubUtils").getCloseButtonElem(q);if(r)c("ConversationNubUtils").addCloseButtonListeners(r,this.$ConversationNub6,this.$ConversationNub27.bind(this))}var s=this.$ConversationNub28();if(s){l.modifyTabState(this.$ConversationNub12,function(u){u.keepAtBottom=true});this.$ConversationNub6.addSubscriptions(c("EventListener").listen(s,"scroll",c("debounce")(this.$ConversationNub29.bind(this),o)),c("Arbiter").subscribe("reflow",this.$ConversationNub30.bind(this)))}var t=this.$ConversationNub31();if(t)this.$ConversationNub6.addSubscriptions(c("EventListener").listen(t,"focusin",this.$ConversationNub32.bind(this,true)),c("EventListener").listen(t,"focusout",this.$ConversationNub32.bind(this,false)))};p.prototype.$ConversationNub17=function(){__p&&__p();var q=this.$ConversationNub33();if(!q){this.$ConversationNub2=null;return}var r=function(){var t=this.getPersistentState();return{permalinkURI:t.permalinkURI,ftID:t.ftID,tabID:t.tabID}}.bind(this),s=new(c("ConversationNubHeader"))(q,r);this.$ConversationNub6.addSubscriptions(s.subscribe("closeButton",this.$ConversationNub27.bind(this)),s.subscribe("showMenu",this.$ConversationNub34.bind(this)),s.subscribe("hideMenu",this.$ConversationNub35.bind(this)),s.subscribe("minimizeButton",this.$ConversationNub36.bind(this,true)),s.subscribe("clickHeader",this.$ConversationNub36.bind(this,true)),s.subscribe("menuPermalinkClick",this.$ConversationNub36.bind(this,false)),c("UFIComposerIsTypingStore").addListener(function(){var t=this.getPersistentStateIfExists();if(!t)return;var u=this.$ConversationNub14,v=c("UFIComposerIsTypingStore").getValueFor(t.ftID);this.$ConversationNub14=v===true;if(u!==this.$ConversationNub14)c("ConversationNubTabsUpdateEventController").informTabsUpdated()}.bind(this)));this.$ConversationNub2=s};p.prototype.$ConversationNub33=function(){return this.$ConversationNub1&&c("DOM").scry(this.$ConversationNub1,".fbNubFlyoutTitlebar")[0]};p.prototype.$ConversationNub23=function(){return this.$ConversationNub1&&c("DOM").scry(this.$ConversationNub1,".fbNubButton")[0]};p.prototype.$ConversationNub28=function(){if(!this.$ConversationNub3&&this.$ConversationNub1)this.$ConversationNub3=c("DOM").scry(this.$ConversationNub1,".uiScrollableAreaWrap")[0];return this.$ConversationNub3};p.prototype.$ConversationNub31=function(){if(!this.$ConversationNub4&&this.$ConversationNub1)this.$ConversationNub4=c("DOM").scry(this.$ConversationNub1,".fbNubFlyoutBodyContent")[0];return this.$ConversationNub4};p.prototype.$ConversationNub37=function(){var q=this.$ConversationNub23();if(q)return c("DOM").scry(q,"._37op")[0];return null};p.prototype.$ConversationNub27=function(){c("ConversationNubUtils").informShouldCloseTab(this.$ConversationNub12,this.getFeedbackTargetID(),c("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT)};p.prototype.$ConversationNub36=function(q){j(this,q)};p.prototype.$ConversationNub34=function(){this.$ConversationNub1&&c("CSS").addClass(this.$ConversationNub1,"_1uw3")};p.prototype.$ConversationNub35=function(){this.$ConversationNub1&&c("CSS").removeClass(this.$ConversationNub1,"_1uw3")};p.prototype.$ConversationNub24=function(){if(this.getPersistentState().isTabRaised)j(this,true);else k(this,true)};p.prototype.$ConversationNub25=function(){if(this.getPersistentState().isBlinkingUnread)this.$ConversationNub9=new Date()};p.prototype.$ConversationNub26=function(){var q=this.$ConversationNub9;if(q&&this.getPersistentState().isBlinkingUnread){var r=new Date();if(r-q>=n)this.$ConversationNub19(false)}this.$ConversationNub9=null};p.prototype.$ConversationNub38=function(){var q=this.$ConversationNub28();if(q){var r=q.scrollHeight;if(r>0&&!this.$ConversationNub39(q)){this.$ConversationNub8=true;q.scrollTop=r}}};p.prototype.$ConversationNub39=function(q){q=q||this.$ConversationNub28();return!!(q&&q.scrollTop>=q.scrollHeight-q.clientHeight-m)};p.prototype.$ConversationNub29=function(){if(!l.getTabStateIfExists(this.$ConversationNub12)||!this.getPersistentState().isTabRaised)return;l.modifyTabState(this.$ConversationNub12,function(q){q.keepAtBottom=this.$ConversationNub39();c("ConversationNubUtils").informShouldRecheckTabVisibility(this)}.bind(this));if(!this.$ConversationNub8)this.clearJewelNotifications();this.$ConversationNub8=false};p.prototype.$ConversationNub32=function(q){if(this.$ConversationNub13===q)return;this.$ConversationNub13=q;if(this.$ConversationNub13)this.clearJewelNotifications();c("ConversationNubTabsUpdateEventController").informTabsUpdated()};p.prototype.getIsFocused=function(){return this.$ConversationNub13};p.prototype.getPageID=function(){return this.$ConversationNub15};p.prototype.getHasText=function(){return this.$ConversationNub14};p.prototype.$ConversationNub30=function(){__p&&__p();var q=this.getPersistentState();if(!q.isTabRaised)return;if(q.keepAtBottom){this.$ConversationNub38();this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.$ConversationNub7=setTimeout(function(){if(q.keepAtBottom)this.$ConversationNub38()}.bind(this),100)}};p.prototype.$ConversationNub18=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.badgeCount=q;this.$ConversationNub21()}.bind(this))};p.prototype.$ConversationNub19=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.isBlinkingUnread=q;this.$ConversationNub22()}.bind(this))};p.prototype.$ConversationNub21=function(){__p&&__p();var q=this.$ConversationNub37();if(!q)return;var r=this.getPersistentState().badgeCount,s=r>0;if(s){c("DOM").setContent(q,r);c("CSS").show(q)}else{c("CSS").hide(q);c("DOM").setContent(q,r)}};p.prototype.$ConversationNub22=function(){if(this.$ConversationNub1){var q=this.getPersistentState().isBlinkingUnread;if(this.$ConversationNub1)c("CSS").conditionClass(this.$ConversationNub1,"_53tf",q)}};p.prototype.getRootDOM=function(){return this.$ConversationNub1};p.prototype.getShouldShowIntroNux=function(){return this.$ConversationNub10};p.prototype.getShouldShowHideNux=function(){return this.$ConversationNub11};p.prototype.getTabID=function(){return this.$ConversationNub12};p.prototype.getNotificationPayloadAlertID=function(){return this.getPersistentState().notifAlertID};p.prototype.getNotificationType=function(){return this.getPersistentState().notificationType};p.prototype.setNotificationType=function(q){l.modifyTabState(this.$ConversationNub12,function(r){r.notificationType=q})};p.prototype.getFeedbackTargetID=function(){return this.getPersistentState().ftID};p.prototype.getPermalinkURI=function(){return this.getPersistentState().permalinkURI};p.prototype.getTitle=function(){return this.getPersistentState().title};p.prototype.getBadgeCount=function(){return this.getPersistentState().badgeCount};p.prototype.getIsRaised=function(){return this.getPersistentState().isTabRaised};p.prototype.getSessionID=function(){return this.$ConversationNub5};p.prototype.markCommentsAsSeenWithoutBadging=function(q){l.modifyTabState(this.$ConversationNub12,function(r){q.forEach(function(s){r.allSeenNewComments[s]=true})})};p.prototype.attemptAddNewCommentsToBadge=function(q){__p&&__p();l.modifyTabState(this.$ConversationNub12,function(r){__p&&__p();q.forEach(function(u){if(r.allSeenNewComments[u])return;r.allSeenNewComments[u]=true;r.unseenCommentsSinceLastCleared[u]=true});var s=Object.keys(r.unseenCommentsSinceLastCleared).length;if(r.hasFakeInitBadge)s+=1;var t=r.badgeCount;this.$ConversationNub18(s);this.$ConversationNub19(s>0&&s>t)}.bind(this))};p.prototype.clearBadge=function(){l.clearTabNotifications(this.$ConversationNub12);this.$ConversationNub21();this.$ConversationNub22()};p.prototype.clearJewelNotifications=function(){var q=this.getNotificationPayloadAlertID();if(q)c("NotificationUserActions").markNotificationsAsRead([q])};p.prototype.popOutAndInformTabUpdate=function(){this.popOut();c("ConversationNubTabsUpdateEventController").informTabsUpdated()};p.prototype.popOut=function(){l.modifyTabState(this.$ConversationNub12,function(q){if(this.$ConversationNub1)c("CSS").addClass(this.$ConversationNub1,"_5r93");q.isTabRaised=true;this.clearBadge();if(q.keepAtBottom)this.$ConversationNub38()}.bind(this))};p.prototype.minimize=function(){l.modifyTabState(this.$ConversationNub12,function(q){if(this.$ConversationNub1)c("CSS").removeClass(this.$ConversationNub1,"_5r93");q.isTabRaised=false;this.$ConversationNub2&&this.$ConversationNub2.hideMenu();this.clearBadge()}.bind(this))};p.prototype.forceReflow=function(){this.$ConversationNub30()};p.prototype.isFormForThisUFI=function(q){return this.$ConversationNub1&&c("containsNode")(this.$ConversationNub1,q)};p.prototype.destroy=function(){__p&&__p();this.$ConversationNub6.release();this.$ConversationNub2&&this.$ConversationNub2.destroy();this.$ConversationNub2=null;this.$ConversationNub7&&clearTimeout(this.$ConversationNub7);this.minimize();if(this.$ConversationNub1){c("DOM").remove(this.$ConversationNub1);c("Arbiter").inform("ConversationNub/destroy",{root:this.$ConversationNub1});this.$ConversationNub1=null}};f.exports=p}),null);
__d("XConversationNubActionTakenController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/conversation/nub_story/action_taken/",{})}),null);
__d("ConversationNubActionTakenReporter",["Arbiter","AsyncRequest","ConversationNubAddCommentSubscription","ConversationNubUtils","PinnedConversationNubsActionTaken","SubscriptionsHandler","XConversationNubActionTakenController"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.$ConversationNubActionTakenReporter2=function(i,j){this.$ConversationNubActionTakenReporter4(j,c("PinnedConversationNubsActionTaken").COMMENT_ADDED)}.bind(this);this.$ConversationNubActionTakenReporter3=function(event,i){var j=i.tabID,k=i.ftID,l=i.tabState,m=i.sessionID,n=i.reason;if(n===c("ConversationNubUtils").CLOSE_REASON_TAB_X_OUT||n===c("ConversationNubUtils").CLOSE_REASON_OVERFLOW_X_OUT||n===c("ConversationNubUtils").CLOSE_REASON_UNPIN)this.$ConversationNubActionTakenReporter4(k,c("PinnedConversationNubsActionTaken").TAB_CLOSED_BY_USER)}.bind(this);this.$ConversationNubActionTakenReporter1=new(c("SubscriptionsHandler"))(c("ConversationNubAddCommentSubscription").subscribe(this.$ConversationNubActionTakenReporter2),c("Arbiter").subscribe(c("ConversationNubUtils").CLOSE_TAB_EVENT,this.$ConversationNubActionTakenReporter3))}h.prototype.destroy=function(){this.$ConversationNubActionTakenReporter1.release()};h.prototype.$ConversationNubActionTakenReporter4=function(i,j){var k=c("XConversationNubActionTakenController").getURIBuilder().getURI();new(c("AsyncRequest"))().setURI(k).setMethod("POST").setData({ft_id:i,action:j}).setAllowCrossPageTransition(true).send()};f.exports=h}),null);
__d("ConversationNubHeader",["csx","ArbiterMixin","Bootloader","ConversationNubUtils","DOM","Event","EventListener","Keys","SubscriptionsHandler","ifRequired","mixin"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j;function k(m,n){return c("EventListener").listen(m,"keydown",function(o){if(c("Event").getKeyCode(o)===c("Keys").RETURN)n(o)})}i=babelHelpers.inherits(l,c("mixin")(c("ArbiterMixin")));j=i&&i.prototype;function l(m,n){j.constructor.call(this);this.$ConversationNubHeader6=false;this.$ConversationNubHeader1=m;this.$ConversationNubHeader3=n;this.$ConversationNubHeader4=null;this.$ConversationNubHeader5=false;this.$ConversationNubHeader2=new(c("SubscriptionsHandler"))();this.$ConversationNubHeader7()}l.prototype.$ConversationNubHeader7=function(){__p&&__p();var m=this.$ConversationNubHeader1;this.$ConversationNubHeader2.addSubscriptions(c("EventListener").listen(m,"click",this.$ConversationNubHeader8.bind(this)));var n=c("ConversationNubUtils").getCloseButtonElem(m);if(n)c("ConversationNubUtils").addCloseButtonListeners(n,this.$ConversationNubHeader2,this.$ConversationNubHeader9.bind(this));var o=this.$ConversationNubHeader10();if(o)this.$ConversationNubHeader2.addSubscriptions(c("EventListener").listen(o,"click",this.$ConversationNubHeader11.bind(this)),k(o,this.$ConversationNubHeader11.bind(this)));var p=this.$ConversationNubHeader12();if(p)this.$ConversationNubHeader2.addSubscriptions(c("EventListener").listen(p,"click",this.$ConversationNubHeader13.bind(this)),c("EventListener").listen(p,"mouseover",this.$ConversationNubHeader14.bind(this)),c("EventListener").listen(p,"focus",this.$ConversationNubHeader15.bind(this)),k(p,this.$ConversationNubHeader16.bind(this)))};l.prototype.$ConversationNubHeader12=function(){return c("DOM").scry(this.$ConversationNubHeader1,"._1rf1")[0]};l.prototype.$ConversationNubHeader10=function(){return c("DOM").scry(this.$ConversationNubHeader1,"._4a56")[0]};l.prototype.$ConversationNubHeader17=function(){return c("ConversationNubUtils").getCloseButtonElem(this.$ConversationNubHeader1)};l.prototype.$ConversationNubHeader9=function(){this.inform("closeButton")};l.prototype.$ConversationNubHeader11=function(m){if(m.type==="click")m.kill();this.inform("minimizeButton")};l.prototype.$ConversationNubHeader8=function(){this.inform("clickHeader")};l.prototype.$ConversationNubHeader18=function(){this.inform("showMenu")};l.prototype.$ConversationNubHeader19=function(){this.inform("hideMenu");var m=this.$ConversationNubHeader12();m&&m.blur()};l.prototype.$ConversationNubHeader20=function(){this.inform("menuPermalinkClick")};l.prototype.$ConversationNubHeader21=function(m){__p&&__p();if(this.$ConversationNubHeader4)return;var n=this.$ConversationNubHeader12();if(!n)return;if(m)this.$ConversationNubHeader5=true;c("Bootloader").loadModules(["React","ReactDOM","ConversationNubHeaderMenu.react"],function(o,p,q){if(this.$ConversationNubHeader6)return;var r=babelHelpers["extends"]({},this.$ConversationNubHeader3(),{onMenuShow:this.$ConversationNubHeader18.bind(this),onMenuHide:this.$ConversationNubHeader19.bind(this),onPermalinkClick:this.$ConversationNubHeader20.bind(this),showOnMount:this.$ConversationNubHeader5});this.$ConversationNubHeader4=p.render(o.createElement(q,r),n)}.bind(this),"ConversationNubHeader")};l.prototype.$ConversationNubHeader13=function(m){m.kill();this.$ConversationNubHeader21(true)};l.prototype.$ConversationNubHeader14=function(){this.$ConversationNubHeader21(false)};l.prototype.$ConversationNubHeader15=function(){this.$ConversationNubHeader21(false)};l.prototype.$ConversationNubHeader16=function(){if(this.$ConversationNubHeader4)this.$ConversationNubHeader4.toggle();else this.$ConversationNubHeader21(true)};l.prototype.hideMenu=function(){this.$ConversationNubHeader4&&this.$ConversationNubHeader4.hide()};l.prototype.destroy=function(){this.$ConversationNubHeader6=true;var m=this.$ConversationNubHeader12();if(m&&this.$ConversationNubHeader4)c("ifRequired")("ReactDOM",function(n){n.unmountComponentAtNode(m)});this.$ConversationNubHeader2.release()};f.exports=l}),null);
__d("ConversationNubTabsUpdateEventController",["Arbiter","ConversationNubUtils"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="ConversationNub/tabsUpdated",i="ConversationNub/minimizedByUser",j="ConversationNub/maximizedByUser",k=false;function l(p){if(!k)c("Arbiter").inform(h,p)}function m(p){return c("Arbiter").subscribe(h,function(q,r){k=true;p(r);k=false})}function n(p,q){q&&c("Arbiter").inform(i,{tab:p});p.minimize();l()}function o(p,q){if(!q&&!c("ConversationNubUtils").allowProgrammaticPopOut())return;q&&c("Arbiter").inform(j,{tab:p});p.popOut();l()}f.exports={TAB_MINIMIZED_BY_USER_EVENT:i,TAB_MAXIMIZED_BY_USER_EVENT:j,informTabsUpdated:l,subscribeToTabsUpdated:m,minimizeAndInformTabUpdate:n,popOutAndInformTabUpdate:o}}),null);
__d("XConversationNubTogglePinController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/conversation/nub_story/toggle_pin/",{ft_id:{type:"String"},pin:{type:"Bool",defaultValue:false},with_render:{type:"Bool",defaultValue:false},notif_setting:{type:"Enum",enumType:1}})}),null);
__d("XConversationsToggleController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/ajax/conversation/toggle_feature/",{turn_conversations_on:{type:"Bool",defaultValue:false}})}),null);
__d("isBusinessURI",["isFacebookURI"],(function a(b,c,d,e,f,g){"use strict";function h(i){return c("isFacebookURI")(i)&&i.getSubdomain()==="business"}f.exports=h}),null);
__d("isGamesURI",["isFacebookURI"],(function a(b,c,d,e,f,g){"use strict";function h(i){return c("isFacebookURI")(i)&&i.getPath().startsWith("/games")}f.exports=h}),null);
__d("ConversationNubUtils",["csx","Arbiter","AsyncRequest","ConversationNubTabState","DOM","Event","EventListener","Keys","NotificationConversationController","URI","XConversationNubTogglePinController","XConversationsToggleController","isBusinessURI","isCanvasAppURI","isGamesURI"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=c("ConversationNubTabState"),j=Object.freeze({DISABLE:"disable",ENABLE:"enable"}),k="ConversationNubUtils/closeTab",l="ConversationNubUtils/unpinnedFromHeader",m="ConversationNubUtils/recheckTabVisibility",n="ConversationNubUtils/openPermalinkFromHeader",o="ConversationNubUtils/turnOff",p="ConversationNubUtils/turnOn",q="tab-x-out",r="browser-tab-sync",s="overflow-x-out",t="unpin";function u(O){var P=Object.values(j);return P.find(function(Q){return Q===O})||null}function v(O,P,Q,R){var S=R||{},T=S.notif_setting,U=c("XConversationNubTogglePinController").getURIBuilder().setString("ft_id",String(O)).setBool("pin",P);if(T)U.setEnum("notif_setting",T);var V=U.getURI(),W=new(c("AsyncRequest"))().setURI(V).setMethod("POST");if(Q)W.setAllowCrossPageTransition(true);W.send()}function w(E){var O=c("XConversationsToggleController").getURIBuilder().setBool("turn_conversations_on",E).getURI();E?N():M();var P=new(c("AsyncRequest"))().setURI(O).setAllowCrossPageTransition(true).setHandler(function(Q){if(Q.getPayload().conversationsStatus)N();else M()}).setErrorHandler(function(Q){E?M():N()}).setMethod("POST");P.send()}function x(O,P,Q){v(O,true,P,Q)}function y(O,P,Q){v(O,false,P,Q)}function z(O,P){x(O,false,P)}function A(O,P){y(O,false,P)}function B(O,P){x(O,true,P)}function C(O,P){y(O,true,P)}function D(){w(false);c("NotificationConversationController").deleteAllTabs()}function E(){w(true)}function F(O){return c("DOM").scry(O,"._4iz6")[0]}function G(O,P,Q){var R=function R(){Q()};P.addSubscriptions(c("EventListener").listen(O,"click",R),c("EventListener").listen(O,"keydown",function(S){if(c("Event").getKeyCode(S)===c("Keys").RETURN)R()}))}function H(){var O=c("URI").getRequestURI();return!c("isCanvasAppURI")(O)&&!c("isBusinessURI")(O)&&!c("isGamesURI")(O)}function I(O,P,Q){var R=i.getLoadedTab(O);if(!R)return;var S=R.getPersistentState(),T=R.getSessionID(),U=R.getPageID();c("Arbiter").inform(k,{tabID:O,ftID:P,tabState:S,sessionID:T,reason:Q,pageID:U})}function J(O){var P=i.getLoadedTab(O);if(!P)return;c("Arbiter").inform(l,{tab:P})}function K(O){c("Arbiter").inform(m,{tab:O})}function L(O){var P=i.getLoadedTab(O);if(!P)return;c("Arbiter").inform(n,{tab:P})}function M(){c("Arbiter").inform(o,{})}function N(){c("Arbiter").inform(p,{})}f.exports={CLOSE_TAB_EVENT:k,UNPIN_FROM_HEADER_EVENT:l,OPEN_PERMALINK_FROM_HEADER_EVENT:n,TURN_CONVERSATIONS_OFF_EVENT:o,TURN_CONVERSATIONS_ON_EVENT:p,CLOSE_REASON_TAB_X_OUT:q,CLOSE_REASON_SYNCHRONIZED_FROM_OTHER_TAB:r,CLOSE_REASON_OVERFLOW_X_OUT:s,CLOSE_REASON_UNPIN:t,coerceToPinRequestNotifSetting:u,sendPinRequest:z,sendUnpinRequest:A,sendPinRequestAcrossTransitions:B,sendUnpinRequestAcrossTransitions:C,getCloseButtonElem:F,addCloseButtonListeners:G,informShouldCloseTab:I,informDidUnpinFromHeaderMenu:J,informShouldRecheckTabVisibility:K,informOpenPermalinkFromHeader:L,allowProgrammaticPopOut:H,turnConversationsOff:D,turnConversationsOn:E}}),null);
__d("ConversationNubPermalinkUtils",["URI","isFacebookURI"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(l){return l.substr(-1)==="/"?l.slice(0,-1):l}function i(l,m){var n=l.getPath(),o=m.getPath();return h(n)===h(o)}function j(l,m,n){var o=l.getQueryData(),p=m.getQueryData(),q=o[n],r=p[n];if(q==null&&r==null)return true;return q===r}function k(l){var m=new(c("URI"))(window.location.href);return m&&l&&c("isFacebookURI")(m)&&c("isFacebookURI")(l)&&i(m,l)&&j(m,l,"fbid")&&j(m,l,"story_fbid")}f.exports={isOnPermalink:k}}),null);
__d("ConversationNubViewportManager",["DockTabsViewportCalculator","DockTabsViewportPinnedConversationTabUtils"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("DockTabsViewportPinnedConversationTabUtils").getMinRequiredWidthForFirstConvoTab;function i(j,k,l){this.$ConversationNubViewportManager1=j;this.$ConversationNubViewportManager3=k;this.$ConversationNubViewportManager2=c("DockTabsViewportCalculator").getInstance(this.$ConversationNubViewportManager1);this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.registerPinnedConvoTabCallbacks(babelHelpers["extends"]({},l,{pinnedConvoTabStateGetter:function(){return this.$ConversationNubViewportManager3}.bind(this)}))}i.prototype.getNumDockTabsToShow=function(j){return this.getCouldFitAtLeastOneDockTab(j)?1:0};i.prototype.getCouldFitAtLeastOneDockTab=function(j){var k=h();return k<=j};i.prototype.forceRecalculatePinnedConvoTabs=function(j){this.$ConversationNubViewportManager2&&this.$ConversationNubViewportManager2.forceRecalculatePinnedConvoTabs(j)};f.exports=i}),null);
__d("ConversationNubVisibilityDedupeUtils",["Bootloader","emptyFunction","ifRequired"],(function a(b,c,d,e,f,g){"use strict";function h(j){c("Bootloader").loadModules(["UFICommentVisibilityStore"],j,"ConversationNubVisibilityDedupeUtils")}function i(j){return c("ifRequired")("UFICommentVisibilityStore",function(k){return k.isFeedbackTargetVisible(j)},c("emptyFunction").thatReturnsFalse)}f.exports={bootloadUFIVisibilityModule:h,isFeedbackTargetVisible:i}}),null);
__d("XNotificationNubStoryController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/conversation/nub_story/",{notif_alert_id:{type:"String"},notif_id:{type:"Int"},ft_id:{type:"String"},force_minimized:{type:"Bool",defaultValue:false}})}),null);
__d("NotificationConversationController",["csx","cx","Arbiter","AsyncRequest","Bootloader","ConversationNub","ConversationNubActionTakenReporter","ConversationNubPermalinkUtils","ConversationNubTabState","ConversationNubTabsUpdateEventController","ConversationNubUtils","ConversationNubViewportManager","ConversationNubVisibilityDedupeUtils","CSS","DOM","PinnedConversationNubsConfig","SubscriptionsHandler","URI","XNotificationNubStoryController","ge","ifRequired","nullthrows"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=c("ConversationNubVisibilityDedupeUtils").isFeedbackTargetVisible,k=1,l=c("ConversationNubTabState"),m=Object.create(null),n=null,o=null,p=null,q=null,r=null,s=null,t=false,u=null,v=null,w=null,x=null,y=Object.create(null);function z(){if(!o)o=c("DOM").scry(c("ge")("pagelet_dock"),"._1mw-")[0];return o}function A(){if(!p){var D=z();if(D)p=c("DOM").scry(D,"._1tvj")[0]}return p}function B(){if(!q){var D=z();if(D)q=c("DOM").scry(D,"._2ikx .fbNubButton")[0]}return q}C.prototype.init=function(){__p&&__p();if(t)return;t=true;var D=new(c("SubscriptionsHandler"))();D.addSubscriptions(c("ConversationNubTabsUpdateEventController").subscribeToTabsUpdated(this.$NotificationConversationController2.bind(this)),c("Arbiter").subscribe(c("ConversationNubUtils").CLOSE_TAB_EVENT,function(E,F){var G=F||{},H=G.tabID;if(H)this.$NotificationConversationController3(H)}.bind(this)));this.$NotificationConversationController1=new(c("ConversationNubActionTakenReporter"))();u=D};C.prototype.$NotificationConversationController4=function(D){var E=n?n.getNumDockTabsToShow(D):k;l.setMaxDockTabs(E)};C.prototype.$NotificationConversationController5=function(D,E){this.$NotificationConversationController4(D);if(E){var F=E.tabToPromote,G=E.tabToOpenIfInDock;if(F&&!l.isTabInDock(F.getTabID()))l.moveTabToDockLeft(F.getTabID());if(c("ConversationNubUtils").allowProgrammaticPopOut()&&G&&l.isTabInDock(G.getTabID()))G.popOut()}this.$NotificationConversationController6(D)};C.prototype.$NotificationConversationController2=function(D){n&&n.forceRecalculatePinnedConvoTabs(D)};C.prototype.$NotificationConversationController6=function(D){__p&&__p();var E=l.getTotalTabCount(),F=l.getNumDockTabs(),G=n?n.getCouldFitAtLeastOneDockTab(D):false,H=E>0&&G,I=F<E&&H,J=z();if(J){c("CSS").conditionClass(J,"_1tvf",H);c("CSS").conditionClass(J,"_1dex",I);c("CSS").conditionClass(J,"_1tvi",I)}var K=c("PinnedConversationNubsConfig").pinnedToLeft?l.getTabsForDockOldestFirst():l.getTabsForDockNewestFirst();K.forEach(function(M){if(M.getIsRaised())M.clearBadge()});var L=l.getTabsForMenuNewestFirst();this.$NotificationConversationController7(K);this.$NotificationConversationController8(L)};C.prototype.handleNotificationsRead=function(D){__p&&__p();this.init();l.getUnsortedLoadedTabs().forEach(function(F){var G=F.getNotificationPayloadAlertID();if(G&&D[G])F.clearBadge()});l.getUnloadedTabs().forEach(function(F){if(F.notifAlertID&&D[F.notifAlertID])l.clearTabNotifications(F.tabID)});var E=l.getTabsForMenuNewestFirst();this.$NotificationConversationController8(E)};C.prototype.handleNewNotificationFromGraphQL=function(D,E){this.init();var F=c("nullthrows")(D),G=F.tab_id,H=F.notification,I=F.feedback_target_id,J=F.permalink_uri,K=c("nullthrows")(H),L=K.notif_id,M=K.alert_id,N=K.notif_type;this.$NotificationConversationController9(c("nullthrows")(G),c("nullthrows")(L),c("nullthrows")(I),c("nullthrows")(M),J?new(c("URI"))(J):null,E,N)};C.prototype.$NotificationConversationController9=function(D,E,F,G,H,I,J){var K=c("XNotificationNubStoryController").getURIBuilder().setString("notif_alert_id",G).setInt("notif_id",E);this.$NotificationConversationController10(F,I);this.$NotificationConversationController11(D,F,J,H,K)};C.prototype.$NotificationConversationController10=function(D,E){if(!y[D])y[D]=E};C.prototype.$NotificationConversationController11=function(D,E,F,G,H){__p&&__p();if(m[D])return;var I=l.getLoadedTab(D);if(I){if(F)I.setNotificationType(F);return}if(c("ConversationNubPermalinkUtils").isOnPermalink(G)||j(E))H.setBool("force_minimized",true);m[D]=true;new(c("AsyncRequest"))().setURI(H.getURI()).setAllowCrossPageTransition(true).setFinallyHandler(function(){delete m[D]}).send()};C.prototype.$NotificationConversationController12=function(D){__p&&__p();var E=true;l.getUnsortedLoadedTabs().forEach(function(F){__p&&__p();var G=F.getFeedbackTargetID(),H=D[G],I=H?Object.keys(H):[];if(I.length){var J=F.getBadgeCount();if(j(G)){F.markCommentsAsSeenWithoutBadging(I);F.clearBadge()}else F.attemptAddNewCommentsToBadge(I);var K=F.getBadgeCount();if(J!==K)E=true}});if(E)c("ConversationNubTabsUpdateEventController").informTabsUpdated()};C.prototype.$NotificationConversationController13=function(D){if(x)return;c("Bootloader").loadModules(["ConversationNubSurveys"],function(E){if(!x)x=new E(D)},"NotificationConversationController")};C.prototype.$NotificationConversationController14=function(D,E,F){__p&&__p();if(w){w.addTab(D,F);delete y[D.getPersistentState().ftID];return}c("Bootloader").loadModules(["ConversationNubLogger"],function(G){if(!w)w=new G(E);w.addTab(D,F);delete y[D.getPersistentState().ftID]},"NotificationConversationController")};C.prototype.$NotificationConversationController15=function(){if(v)return;c("Bootloader").loadModules(["ConversationNubUFICentralUpdateManager"],function(D){if(v)return;v=new D(this.$NotificationConversationController12.bind(this))}.bind(this),"NotificationConversationController")};C.prototype.$NotificationConversationController7=function(D){var E=A();if(!E)return;c("Bootloader").loadModules(["React","ReactDOM","ConversationNubDockedTabGroup.react"],function(F,G,H){s=G.render(F.createElement(H,{dockTabs:D}),E)},"NotificationConversationController")};C.prototype.$NotificationConversationController16=function(D){D.popOut();c("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:D})};C.prototype.$NotificationConversationController8=function(D){var E=B();if(!E)return;c("Bootloader").loadModules(["React","ReactDOM","ConversationNubCollapsedSelectorMenu.react"],function(F,G,H){r=G.render(F.createElement(H,{menuTabs:D,onTabSelected:this.$NotificationConversationController16}),E)}.bind(this),"NotificationConversationController")};C.prototype.$NotificationConversationController17=function(){if(!n){var D=z();if(D){var E={onAvailableWidthChanged:this.$NotificationConversationController5.bind(this)};n=new(c("ConversationNubViewportManager"))(D,l,E)}}};C.prototype.storyFromServer=function(D,E){__p&&__p();if(!t)this.init();var F=E.attempt_open_on_init,G=E.ft_id,H=E.init_without_badge,I=E.notif_alert_id,J=E.notification_type,K=E.permalink_uri,L=E.promote_on_init,M=E.tab_add_source,N=E.tab_id,O=E.title,P=E.should_show_intro_nux,Q=E.should_show_hide_nux,R=E.page_id,S=l.getLoadedTab(N);if(S){if(L||F)c("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:L?S:null,tabToOpenIfInDock:F?S:null});return}H=H||j(G);var T=l.getTabStateIfExists(N);if(T)H=null;else{var U=c("ConversationNub").createDefaultState(N,K,G,I,J,O);l.addTabState(U)}var V=new(c("ConversationNub"))(D,N,H,R,Boolean(P),Boolean(Q));l.addLoadedTab(N,V);F=F||V.getPersistentState().isTabRaised;this.$NotificationConversationController15();this.$NotificationConversationController17();c("ConversationNubTabsUpdateEventController").informTabsUpdated({tabToPromote:L?V:null,tabToOpenIfInDock:F?V:null});this.$NotificationConversationController13(l);var W=y[G]||M||"unknown";this.$NotificationConversationController14(V,l,W)};C.prototype.deleteAllTabs=function(){l.deleteAllTabs();c("ConversationNubTabsUpdateEventController").informTabsUpdated()};C.prototype.$NotificationConversationController3=function(D){var E=l.deleteTab(D);if(E)c("ConversationNubTabsUpdateEventController").informTabsUpdated()};C.prototype.unsubscribe=function(){__p&&__p();u&&u.release();u=null;w&&w.destroy();w=null;x&&x.destroy();x=null;v&&v.destroy();v=null;this.$NotificationConversationController1.destroy();c("ifRequired")("ReactDOM",function(D){var E=B();if(r&&E)D.unmountComponentAtNode(E);var F=A();if(s&&F)D.unmountComponentAtNode(F)})};function C(){}f.exports=new C()}),null);
__d("PinnedConversationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$PinnedConversationTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$PinnedConversationTypedLogger1,c("Banzai").VITAL)};h.prototype.logImmediately=function(){c("GeneratedLoggerUtils").log("logger:PinnedConversationLoggerConfig",this.$PinnedConversationTypedLogger1,{signal:true})};h.prototype.clear=function(){this.$PinnedConversationTypedLogger1={};return this};h.prototype.getData=function(){return babelHelpers["extends"]({},this.$PinnedConversationTypedLogger1)};h.prototype.updateData=function(j){this.$PinnedConversationTypedLogger1=babelHelpers["extends"]({},this.$PinnedConversationTypedLogger1,j);return this};h.prototype.setAttemptOpenOnInit=function(j){this.$PinnedConversationTypedLogger1.attempt_open_on_init=j;return this};h.prototype.setBadgeCount=function(j){this.$PinnedConversationTypedLogger1.badge_count=j;return this};h.prototype.setClientEventTimeMs=function(j){this.$PinnedConversationTypedLogger1.client_event_time_ms=j;return this};h.prototype.setEvent=function(j){this.$PinnedConversationTypedLogger1.event=j;return this};h.prototype.setFtID=function(j){this.$PinnedConversationTypedLogger1.ft_id=j;return this};h.prototype.setIsRaised=function(j){this.$PinnedConversationTypedLogger1.is_raised=j;return this};h.prototype.setNotificationType=function(j){this.$PinnedConversationTypedLogger1.notification_type=j;return this};h.prototype.setPageID=function(j){this.$PinnedConversationTypedLogger1.page_id=j;return this};h.prototype.setPromoteOnInit=function(j){this.$PinnedConversationTypedLogger1.promote_on_init=j;return this};h.prototype.setReason=function(j){this.$PinnedConversationTypedLogger1.reason=j;return this};h.prototype.setTabID=function(j){this.$PinnedConversationTypedLogger1.tab_id=j;return this};h.prototype.setTabSessionID=function(j){this.$PinnedConversationTypedLogger1.tab_session_id=j;return this};h.prototype.setTabsInDock=function(j){this.$PinnedConversationTypedLogger1.tabs_in_dock=j;return this};h.prototype.setTabsInMenu=function(j){this.$PinnedConversationTypedLogger1.tabs_in_menu=j;return this};h.prototype.setVC=function(j){this.$PinnedConversationTypedLogger1.vc=j;return this};h.prototype.setWindowInnerHeight=function(j){this.$PinnedConversationTypedLogger1.window_inner_height=j;return this};h.prototype.setWindowInnerWidth=function(j){this.$PinnedConversationTypedLogger1.window_inner_width=j;return this};var i={attempt_open_on_init:true,badge_count:true,client_event_time_ms:true,event:true,ft_id:true,is_raised:true,notification_type:true,page_id:true,promote_on_init:true,reason:true,tab_id:true,tab_session_id:true,tabs_in_dock:true,tabs_in_menu:true,vc:true,window_inner_height:true,window_inner_width:true};f.exports=h}),null);
__d("ConversationNubLogger",["Arbiter","ConversationNubAddCommentSubscription","ConversationNubTabsUpdateEventController","ConversationNubUtils","PinnedConversationTypedLogger","SubscriptionsHandler","UFIUIEvents"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(i){this.$ConversationNubLogger1=new(c("SubscriptionsHandler"))();this.$ConversationNubLogger2=i;this.$ConversationNubLogger3();this.$ConversationNubLogger4()}h.prototype.$ConversationNubLogger4=function(){__p&&__p();this.$ConversationNubLogger1.addSubscriptions(c("ConversationNubAddCommentSubscription").subscribe(function(i){var j=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_add_comment");this.$ConversationNubLogger5(j,i)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("UFIUIEvents").ReactionButtonClicked,function(i,j){var k=j.ft_id;if(!k)return;var l=this.$ConversationNubLogger2.getLoadedTabByFeedbackTarget(k);if(!l)return;var m=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_react_post");this.$ConversationNubLogger5(m,l)}.bind(this)))};h.prototype.$ConversationNubLogger3=function(){__p&&__p();this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubUtils").CLOSE_TAB_EVENT,function(i,j){var k=j.tabState,l=j.sessionID,m=j.reason,n=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_close").setReason(m);this.$ConversationNubLogger6(n,k,l)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubUtils").UNPIN_FROM_HEADER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_hide");this.$ConversationNubLogger5(l,k)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubTabsUpdateEventController").TAB_MAXIMIZED_BY_USER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_maximize");this.$ConversationNubLogger5(l,k)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubTabsUpdateEventController").TAB_MINIMIZED_BY_USER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_minimize");this.$ConversationNubLogger5(l,k)}.bind(this)));this.$ConversationNubLogger1.addSubscriptions(c("Arbiter").subscribe(c("ConversationNubUtils").OPEN_PERMALINK_FROM_HEADER_EVENT,function(i,j){var k=j.tab,l=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_open_permalink_from_header");this.$ConversationNubLogger5(l,k)}.bind(this)))};h.prototype.$ConversationNubLogger5=function(i,j){i.setTabID(j.getTabID()).setPageID(j.getPageID()).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$ConversationNubLogger2.getNumMenuTabs()).setTabsInDock(this.$ConversationNubLogger2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight);i.setFtID(j.getFeedbackTargetID()).setIsRaised(j.getIsRaised()).setBadgeCount(j.getBadgeCount()).setTabSessionID(j.getSessionID());var k=j.getNotificationType();if(k)i.setNotificationType(k);i.log()};h.prototype.$ConversationNubLogger6=function(i,j,k){i.setTabID(j.tabID).setClientEventTimeMs(Date.now()).setTabsInMenu(this.$ConversationNubLogger2.getNumMenuTabs()).setTabsInDock(this.$ConversationNubLogger2.getNumDockTabs()).setWindowInnerWidth(window.innerWidth).setWindowInnerHeight(window.innerHeight);i.setFtID(j.ftID).setIsRaised(j.isTabRaised).setBadgeCount(j.badgeCount).setTabSessionID(k);if(j.notificationType)i.setNotificationType(j.notificationType);i.log()};h.subscriptionTriggered=function(i){new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_subscription_triggered").setReason(i).log()};h.prototype.addTab=function(i,j){var k=new(c("PinnedConversationTypedLogger"))().setEvent("pinned_conversation_tab_add").setReason(j);this.$ConversationNubLogger5(k,i)};h.prototype.destroy=function(){this.$ConversationNubLogger1.release()};f.exports=h}),null);
__d("ConversationNotificationListeners",["Bootloader","ConversationNubAddTabSource","ConversationNubLogger","FacebookWebNotificationsSubscription","NotificationConstants","NotificationUpdates","once"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=c("NotificationConstants").PayloadSourceType.LIVE_SEND;function i(){c("NotificationUpdates").subscribe("update-notifications",function(k,l){if(l.payloadsource===h&&l.readState&&Object.keys(l.readState).length)c("Bootloader").loadModules(["NotificationConversationController"],function(m){m.handleNotificationsRead(l.readState)},"ConversationNotificationListeners")})}var j=c("once")(function(){i();c("FacebookWebNotificationsSubscription").subscribe({event:"NEW_PINNED_CONVERSATION",callback:function k(l){c("ConversationNubLogger").subscriptionTriggered("graphql");c("Bootloader").loadModules(["NotificationConversationController"],function(m){m.handleNewNotificationFromGraphQL(l,c("ConversationNubAddTabSource").NOTIFICATION)},"ConversationNotificationListeners")}})});f.exports={initialize:function k(){j()}}}),null);
__d("FBPaymentsDialogStore",["FBPaymentsDialogActions","FBPaymentsDispatcher","FluxStore"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("FluxStore"));i=h&&h.prototype;function j(){i.constructor.call(this,c("FBPaymentsDispatcher"));this.__moduleID=f.id;this.$FBPaymentsDialogStore1={dialogClass:null,dialogProps:null}}j.prototype.__onDispatch=function(k){var l=k.type,m=k.data;switch(l){case c("FBPaymentsDialogActions").types.SHOW_DIALOG:this.$FBPaymentsDialogStore1={dialogClass:m.dialogClass,dialogProps:m.dialogProps};this.__emitChange();break;case c("FBPaymentsDialogActions").types.HIDE_DIALOG:this.$FBPaymentsDialogStore1={dialogClass:null,dialogProps:null};this.__emitChange();break}};j.prototype.getState=function(){return this.$FBPaymentsDialogStore1};f.exports=new j()}),null);
__d("FBPaymentsDialogContainer.react",["FBPaymentsDialogStore","FBPaymentsDispatcher","FluxContainer","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;j.calculateState=function(){return c("FBPaymentsDialogStore").getState()};j.getStores=function(){return[c("FBPaymentsDialogStore")]};j.prototype.UNSAFE_componentWillMount=function(){c("FBPaymentsDispatcher").explicitlyRegisterStore(c("FBPaymentsDialogStore"))};j.prototype.render=function(){if(!this.state.dialogClass)return null;var k=this.state.dialogClass;return c("React").createElement(k,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))};function j(){h.apply(this,arguments)}f.exports=c("FluxContainer").create(j)}),null);
__d("FBPaymentsDialogContainerMount",["FBPaymentsDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("FBPaymentsDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("ChatTimezoneWarning",["MercuryParticipants","MercuryViewer","MessengerBotIDs"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=1,i={updateUserTimezoneWarning:function j(k,l,m){__p&&__p();c("MercuryParticipants").get(c("MercuryViewer").getID(),function(n){__p&&__p();var o=n.employee,p=n.timezone,q=0;if(k.timezone_warning_dismiss_count!==undefined){var r=k.timezone_warning_dismiss_count;for(var s=Object.entries(r),t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var v;if(t){if(u>=s.length)break;v=s[u++]}else{u=s.next();if(u.done)break;v=u.value}var w=v,x=w[0],y=w[1];if(x===n.fbid)q=Number(y)}}else return;if(o&&p&&q<h)c("MercuryParticipants").getMulti(k.participants,function(z){__p&&__p();var A={},B=true;for(var C in z){B=B&&z[C].employee;var D=!!c("MessengerBotIDs")[z[C].fbid];if(z[C].timezone!==undefined&&z[C].timezone!==null&&p!==z[C].timezone&&!D){var E=z[C].fbid;A[E]=z[C]}}if(Object.keys(A).length>0&&B){A.self=n;l(A)}else m()})})}};f.exports=i}),null);
__d("ChatVideoCallButton.react",["cx","fbt","invariant","Bootloader","FantaAvailableStatus","FBIDCheck","FBRTCCallabilityStore","FBRTCCore","immutable","ImmutableObject","Keys","LayerFadeOnHide","Link.react","MercuryIDs","MercuryParticipants","MercuryThreadIDMap","MessengerRTCFunnelLogger","ReactComponentWithPureRenderMixin","React","RTCCallState","StoreAndPropBasedStateMixin","TrackingNodes","FBRTCLogger","VideoCallTypedLogger","XUIAmbientNUX.react"],(function a(b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k=c("MercuryThreadIDMap").get(),l=c("FBRTCLogger").Trigger,m=c("React").PropTypes,n={isCallable:false,shown:false,user:null},o=c("React").createClass({displayName:"ChatVideoCallButton",mixins:[c("ReactComponentWithPureRenderMixin"),c("StoreAndPropBasedStateMixin")(c("FBRTCCallabilityStore"),c("MercuryParticipants"))],propTypes:{isAudio:m.bool,isGroupChat:m.bool,onRTCNuxCloseButtonClick:m.func.isRequired,rtcNuxShown:m.bool.isRequired,threadID:m.string,thread:m.object,viewer:m.string.isRequired,shown:m.bool,rtcCallData:m.object.isRequired},getDefaultProps:function p(){return{shown:true,rtcCallData:{call_state:"NO_ONGOING_CALL"}}},statics:{calculateState:function p(q){__p&&__p();if(!q.threadID)return babelHelpers["extends"]({},n);if(q.isGroupChat)return{isCallable:true,shown:q.shown,user:null};var r=c("MercuryIDs").getUserIDFromThreadID(q.threadID);if(r===q.viewer||!c("FBIDCheck").isUser_deprecated(r))return babelHelpers["extends"]({},n);r&&c("FBIDCheck").isUser_deprecated(r)||j(0);var s=c("MercuryIDs").getParticipantIDFromUserID(r),t=c("MercuryParticipants").getOrFetch(s);return{isCallable:!c("FBRTCCallabilityStore").isBlocked(r,q.thread)&&c("FBRTCCallabilityStore").isCallable(r,q.thread),shown:q.shown,user:t}}},getTooltipLabel:function p(){if(this.props.isGroupChat)return this.props.isAudio?i._("Start a group call"):i._("Start a group video chat");var q=this.state.user;if(!q)return undefined;return this.props.isAudio?c("FBRTCCallabilityStore").voiceCallButtonTooltip(q.fbid,q.short_name,this.state.isCallable,this.props.thread):c("FBRTCCallabilityStore").callButtonTooltip(q.fbid,q.short_name,this.state.isCallable,this.props.thread)},render:function p(){if(!this.state.shown)return null;var q=c("TrackingNodes").getTrackingInfo(this.props.isAudio?c("TrackingNodes").types.VIDEOCHAT:c("TrackingNodes").types.VOICECHAT),r=JSON.stringify({videochat:"call_clicked_bhat_tab"}),s=this.props.threadID&&c("FantaAvailableStatus").isAvailable(this.props.thread,this.props.threadID),t=s&&this.state.isCallable;return c("React").createElement("div",null,c("React").createElement(c("Link.react"),{"aria-label":this.getTooltipLabel(),className:"button _3olv"+(this.props.isAudio?" _2fpc":"")+(!this.props.isAudio?" _2fpd":"")+(this.state.isCallable?" enabled":""),"data-ft":q,"data-gt":r,"data-hover":"tooltip","data-tooltip-content":this.getTooltipLabel(),"data-tooltip-position":"above",onClick:this._handleClick,onKeyUp:this._handleKeyUp,ref:"button"}),c("React").createElement("div",{className:t&&!this.props.isAudio?"_18pe":""}),c("React").createElement(c("XUIAmbientNUX.react"),{alignment:"right",behaviors:{LayerFadeOnHide:c("LayerFadeOnHide")},contextRef:function(){return this.refs.button}.bind(this),onCloseButtonClick:this.props.onRTCNuxCloseButtonClick,shown:this.props.rtcNuxShown,width:"auto"},i._("You can now make a group call.")))},_handleClick:function p(q){q.preventDefault();this._startCall()},_handleKeyUp:function p(q){q.preventDefault();if(q.keyCode!==c("Keys").RETURN)return;if(q.target){q.target instanceof HTMLElement||j(0);q.target.blur()}this._startCall()},_startCall:function p(){c("MessengerRTCFunnelLogger").startFunnel("ChatTab");if(!this.state.isCallable){c("MessengerRTCFunnelLogger").endFunnel("callee_not_callable");return}this.props.onRTCNuxCloseButtonClick();this._initiateCall()},_initiateCall:function p(){__p&&__p();var q=this.props,r=q.isAudio,s=q.isGroupChat,t=q.threadID;!!t||j(0);var u=r?"audio":"video";if(s)if(c("MercuryIDs").isLocalThread(t))k.getServerIDFromClientID(t,function(v){return this._initiateGroupCall(v)}.bind(this));else{c("MessengerRTCFunnelLogger").appendAction("start_in_group_thread");this._initiateGroupCall(c("MercuryIDs").getThreadFBIDFromThreadID(t))}else{c("MessengerRTCFunnelLogger").appendAction("start_in_p2p_thread");c("FBRTCCore").startOutgoingCall(this.state.user.fbid,u,!!r);new(c("VideoCallTypedLogger"))().setEvent("chat_tab_call_click").log()}},_initiateGroupCall:function p(q){__p&&__p();var r=this.props,s=r.isAudio,t=r.rtcCallData,u=t.call_state,v=t.server_info_data;if(u!=="NO_ONGOING_CALL"&&v){c("MessengerRTCFunnelLogger").appendAction("join_existing_call");c("FBRTCCore").startGroupCall({conferenceName:"GROUP:"+q,hasVideo:!s,serverInfoData:v,trigger:u!==c("RTCCallState").AUDIO_GROUP_CALL?s?l.MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_AUDIO_BUTTON:l.MULTIWAY_THREAD_HEADER_JOIN_AUDIO_CALL_VIDEO_BUTTON:s?l.MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_AUDIO_BUTTON:l.MULTIWAY_THREAD_HEADER_JOIN_VIDEO_CALL_VIDEO_BUTTON});return}c("Bootloader").loadModules(["FBRTCSupport","MercuryThreads","MessengerParticipantsFetcher.bs","FBRTCUnsupportedBrowserMessage","MessengerRTCGroupCallParticipantsPickerDialogController"],function(w,x,y,z,A){__p&&__p();if(!w.isGroupCallWebtrcSupported()){c("MessengerRTCFunnelLogger").endFunnel("unsupported_browser");z.showForOutgoingGroupCall();return}x.get().getThreadMeta(this.props.threadID,function(B){var C=B.participants?B.participants.filter(function(D){return D!==c("MercuryIDs").getParticipantIDFromUserID(this.props.viewer)}.bind(this)).map(function(D){return c("MercuryIDs").getUserIDFromParticipantID(D)}):[];if(C.length>0)y.fetch({ids:C}).done(function(C){c("MessengerRTCFunnelLogger").appendAction("render_participant_picker");A.render({participants:c("immutable").Map(C.map(function(D){return[D.id,new(c("ImmutableObject"))(D)]})),thread:B,viewerID:this.props.viewer,trigger:this.props.isAudio?l.MULTIWAY_THREAD_HEADER_AUDIO_BUTTON:l.MULTIWAY_THREAD_HEADER_VIDEO_BUTTON,conferenceName:"GROUP:"+q,hasVideo:!this.props.isAudio})}.bind(this))}.bind(this))}.bind(this),"ChatVideoCallButton.react")}});f.exports=o}),null);
__d("FantaTabsEagerBootloader",["Bootloader","emptyFunction","ifRequired"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h=function j(k){c("ifRequired")("FantaAppStore",function(l){return l.addReducers(k)});h=c("emptyFunction")},i={bootload:function j(){c("ifRequired")("FantaTabsSlimApp",function(k){k.silentPumpUp()});c("Bootloader").loadModules(["FantaReducersGetMessages","FantaTabsReactApp","MessengerGraphQLThreadFetcher.bs"],function(k){h(k)},"FantaTabsEagerBootloader")}};f.exports=i}),null);
__d("PureStoreBasedStateMixin",["invariant","FluxMixinLegacyInstrumentation","StoreBasedStateMixinHelper","setImmediate"],(function a(b,c,d,e,f,g,h){"use strict";__p&&__p();var i=function(){__p&&__p();for(var j=arguments.length,k=Array(j),l=0;l<j;l++)k[l]=arguments[l];return c("FluxMixinLegacyInstrumentation").addInstrumentation({_callCalculateState:function m(){return this.constructor.calculateState()},getInitialState:function m(){this._onInitialStateForInstrumentation&&this._onInitialStateForInstrumentation();return this._callCalculateState()},UNSAFE_componentWillMount:function m(){__p&&__p();this.constructor.calculateState||h(0);this._recalculateStateID=null;var n=function(){var o,p=this;if(this.isMounted())(function(){var k=p._collectStoreEmitsForInstrumentation?p._collectStoreEmitsForInstrumentation():null,q=p._callCalculateState();p.setState(p._logStoreEmitsForInstrumentation!=null?function(){k!=null&&this._logStoreEmitsForInstrumentation&&this._logStoreEmitsForInstrumentation(k);return q}.bind(p):q)})();this._recalculateStateID=null}.bind(this);this._mixin=new(c("StoreBasedStateMixinHelper"))(k);this._mixin.subscribeCallback(function(){if(this._recalculateStateID===null)this._recalculateStateID=c("setImmediate")(n)}.bind(this),this._addStoreEmitForInstrumentation)},componentWillUnmount:function m(){this._mixin.release();this._mixin=null}})}.bind(this);f.exports=i}),null);
__d("MNCommerceDialogContainer.react",["MNCommerceDialogStateStore","PureStoreBasedStateMixin","React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").createClass({displayName:"MNCommerceDialogContainer",mixins:[c("PureStoreBasedStateMixin")(c("MNCommerceDialogStateStore"))],statics:{calculateState:function i(){var j=c("MNCommerceDialogStateStore").getDialogContainer();return{dialogContainer:j}}},render:function i(){var j=this.state.dialogContainer;if(!j)return null;return c("React").createElement(j,null)}});f.exports=h}),null);
__d("MNCommerceDialogContainerMount",["MNCommerceDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("MNCommerceDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("FBRTCIceStatsParser",[],(function a(b,c,d,e,f,g){__p&&__p();var h=null;i.getInstance=function(){"use strict";if(!h)h=new i();return h};function i(){"use strict"}i.prototype.extractIceInfo=function(j){"use strict";var k=[],l=j.split("\r\n");for(var m=0;m<l.length;m++){var n=l[m];if(this.$FBRTCIceStatsParser1(n))k.push({gen:this.$FBRTCIceStatsParser2(n),type:this.$FBRTCIceStatsParser3(n)})}return k};i.prototype.$FBRTCIceStatsParser1=function(j){"use strict";return j.indexOf("candidate:")>-1};i.prototype.$FBRTCIceStatsParser2=function(j){"use strict";var k=0,l=j.match(/generation (\d+)/);if(l)k=parseInt(l[1],10);return k};i.prototype.$FBRTCIceStatsParser3=function(j){"use strict";var k=j.match(/typ (host|relay|srflx|prflx)/);if(k)return k[1];else return"unknown"};f.exports=i}),null);
__d("FBRTCCallSummary",["FBRTCConstants","FBRTCIceStatsParser","FBRTCLogger","FBRTCUtils","SiteData","UserAgentData","performanceNow"],(function a(b,c,d,e,f,g){__p&&__p();var h=5*60*1e3,i={CALL_STARTED:"started",SENT_OFFER:"s_o",RECV_OFFER:"r_o",SENT_OFFER_ACK:"s_oack",RECV_OFFER_ACK:"r_oack",SENT_RETRIED_OFFER:"s_o2",RECV_RETRIED_OFFER:"r_o2",SENT_RETRIED_OFFER_ACK:"s_oack2",RECV_RETRIED_OFFER_ACK:"r_oack2",SENT_PRANSWER:"s_pr",RECV_PRANSWER:"r_pr",NETWORK_READY:"network_ready",SENT_ANSWER:"s_a",RECV_ANSWER:"r_a",SENT_ANSWER_ACK:"s_aack",RECV_ANSWER_ACK:"r_aack",SENT_RETRIED_ANSWER:"s_a2",RECV_RETRIED_ANSWER:"r_a2",SENT_RETRIED_ANSWER_ACK:"s_aack2",RECV_RETRIED_ANSWER_ACK:"r_aack2",SENT_OK:"s_ok",RECV_OK:"r_ok",CALL_CONNECTED:"connected",CALL_ENDED:"ended"},j={FELLBACK_TO_AUDIO:"f_a",MEDIA_REQUESTED:"m_r",MEDIA_SUCCEEDED:"m_s",POPUP_OPENED:"opened",PRESSED_ANSWER:"p_a",TESTER_RETRIES:"t_r"},k={ESCALATION_IS_AVAILABLE:"esc_available",USER_INITIATED_REQUEST:"out_started",RECEIVED_INCOMING_REQUEST:"inc_started",REJECTED_INVALID_P2P_STATE:"rej_invalid_state",CONNECTING_TO_MULTIWAY:"u_connecting_mw",CONNECTED_TO_MULTIWAY:"u_connected_mw",PEER_CONNECTING_TO_MULTIWAY:"p_connecting_mw",PEER_CONNECTED_TO_MULTIWAY:"p_connected_mw",READY_TO_ESCALATE:"ready_esc",PEER_FAILED_TO_CONNECT_TO_MULTIWAY:"p_fail_conn",MULTIWAY_CALL_ENDED:"mw_call_ended",TIMED_OUT:"timed_out",PEER_ABORTED:"p_aborted",INTERNAL_ERROR:"internal_err"},l={ESCALATION_INITIATION_BUTTON_CLICKED:"esc_init_button",ESCALATION_APPROVED_BUTTON_CLICKED:"esc_appr_button",ESCALATION_DECLINED_BUTTON_CLICKED:"esc_decl_button",USERMEDIA_REQUEST:"media_req",USERMEDIA_SUCCESS:"media_success",USERMEDIA_FAILURE:"media_fail",SENT_ESC_REQUEST:"s_esc_req",RECV_ESC_REQUEST:"r_esc_req",SENT_ESC_REQUEST_ACK:"s_esc_req_ack",RECV_ESC_REQUEST_ACK:"s_esc_req_ack",SENT_ESC_RESPONSE:"s_esc_rep",RECV_ESC_ACCEPT:"r_esc_accept",RECV_ESC_DECLINE:"r_esc_decl",RECV_ESC_TIMEOUT:"r_esc_timeout"};function m(n){"use strict";__p&&__p();this.peerID=String(n.peerID);this.callID=String(n.callID);this.$FBRTCCallSummary1=n.isCaller;this.$FBRTCCallSummary2=c("FBRTCUtils").getLocalUploadLogLevel();this.$FBRTCCallSummary13=new Date().valueOf();this.$FBRTCCallSummary3=null;this.$FBRTCCallSummary4={};this.$FBRTCCallSummary6={};this.$FBRTCCallSummary7={};this.$FBRTCCallSummary12={};this.$FBRTCCallSummary36=null;this.$FBRTCCallSummary37=null;this.$FBRTCCallSummary38=null;this.$FBRTCCallSummary15=0;this.$FBRTCCallSummary16=0;this.$FBRTCCallSummary35=false;this.$FBRTCCallSummary23={};this.$FBRTCCallSummary24={};this.$FBRTCCallSummary8={};this.$FBRTCCallSummary9={};this.$FBRTCCallSummary10={};this.$FBRTCCallSummary11={};this.$FBRTCCallSummary25=null;this.$FBRTCCallSummary18=c("performanceNow")();this.$FBRTCCallSummary14=0;this.$FBRTCCallSummary5={};this.$FBRTCCallSummary17=this.$FBRTCCallSummary18;this.$FBRTCCallSummary19=0;this.$FBRTCCallSummary20={};this.addExtraInfo(c("FBRTCLogger").Key.DEVICE_INFO,this.$FBRTCCallSummary39());this.$FBRTCCallSummary40();this.$FBRTCCallSummary22=c("FBRTCIceStatsParser").getInstance();this.$FBRTCCallSummary21=c("FBRTCLogger").getInstance()}m.prototype.toJsonString=function(){"use strict";this.$FBRTCCallSummary16=new Date().valueOf();return JSON.stringify({version:m.CURRENT_SUMMARY_VERSION,peerID:this.peerID,callID:this.callID,isCaller:this.$FBRTCCallSummary1,uploadLogLevel:this.$FBRTCCallSummary2,clientVersion:this.$FBRTCCallSummary25,callType:this.$FBRTCCallSummary30,isUsingMultiway:this.$FBRTCCallSummary26,conferenceName:this.$FBRTCCallSummary28,activeConn:this.$FBRTCCallSummary27,escP2PCallID:this.$FBRTCCallSummary29,escConfName:this.$FBRTCCallSummary32,serverInfoData:this.$FBRTCCallSummary31,localVideoDuration:this.$FBRTCCallSummary33,remoteVideoDuration:this.$FBRTCCallSummary34,startTime:this.$FBRTCCallSummary13,trigger:this.$FBRTCCallSummary3,signalingTime:this.$FBRTCCallSummary4,escStateTimes:this.$FBRTCCallSummary6,applicationEventTime:this.$FBRTCCallSummary7,videoEscTimes:this.$FBRTCCallSummary12,endCallReason:this.$FBRTCCallSummary36,endCallSubreason:this.$FBRTCCallSummary37,isRemoteEnded:this.$FBRTCCallSummary38,lastUpdatedTime:this.$FBRTCCallSummary15,lastSerializedTime:this.$FBRTCCallSummary16,unsetOnRetrieve:this.$FBRTCCallSummary35,openCount:this.$FBRTCCallSummary19,extraInfo:this.$FBRTCCallSummary20,pcStats:this.$FBRTCCallSummary23,captureStats:this.$FBRTCCallSummary24,gen0IceSentCount:this.$FBRTCCallSummary8,gen0IceReceivedCount:this.$FBRTCCallSummary9,iceSentCount:this.$FBRTCCallSummary10,iceReceivedCount:this.$FBRTCCallSummary11,newSignalingTime:this.$FBRTCCallSummary5,accumulatedCallTime:this.$FBRTCCallSummary41()})};m.fromJsonString=function(n){"use strict";__p&&__p();var o=void 0;try{o=JSON.parse(n)}catch(p){return null}if(o.version!==m.CURRENT_SUMMARY_VERSION)return null;if(!Object.prototype.hasOwnProperty.call(o,"peerID")||!Object.prototype.hasOwnProperty.call(o,"callID")||!Object.prototype.hasOwnProperty.call(o,"isCaller")||!Object.prototype.hasOwnProperty.call(o,"startTime")||!Object.prototype.hasOwnProperty.call(o,"trigger")||!Object.prototype.hasOwnProperty.call(o,"signalingTime")||!Object.prototype.hasOwnProperty.call(o,"endCallReason")||!Object.prototype.hasOwnProperty.call(o,"isRemoteEnded")||!Object.prototype.hasOwnProperty.call(o,"lastUpdatedTime")||!Object.prototype.hasOwnProperty.call(o,"lastSerializedTime"))return null;var q=new m({peerID:o.peerID,callID:o.callID,isCaller:o.isCaller});q.$FBRTCCallSummary2=o.uploadLogLevel;q.$FBRTCCallSummary25=o.clientVersion;q.$FBRTCCallSummary13=o.startTime;q.$FBRTCCallSummary3=o.trigger;q.$FBRTCCallSummary4=o.signalingTime;q.$FBRTCCallSummary36=o.endCallReason;q.$FBRTCCallSummary37=o.endCallSubreason;q.$FBRTCCallSummary38=o.isRemoteEnded;q.$FBRTCCallSummary15=o.lastUpdatedTime;q.$FBRTCCallSummary16=o.lastSerializedTime;if(o.callType)q.$FBRTCCallSummary30=o.callType;if(o.isUsingMultiway!=null)q.$FBRTCCallSummary26=o.isUsingMultiway;if(o.conferenceName)q.$FBRTCCallSummary28=o.conferenceName;if(o.escP2PCallID)q.$FBRTCCallSummary29=o.escP2PCallID;if(o.activeConn)q.$FBRTCCallSummary27=o.activeConn;if(o.escConfName)q.$FBRTCCallSummary32=o.escConfName;if(o.serverInfoData)q.$FBRTCCallSummary31=o.serverInfoData;if(o.localVideoDuration)q.$FBRTCCallSummary33=o.localVideoDuration;if(o.remoteVideoDuration)q.$FBRTCCallSummary34=o.remoteVideoDuration;if(o.unsetOnRetrieve)q.$FBRTCCallSummary35=o.unsetOnRetrieve;if(o.openCount)q.$FBRTCCallSummary19=o.openCount;if(o.extraInfo)q.$FBRTCCallSummary20=o.extraInfo;if(o.pcStats)q.$FBRTCCallSummary23=o.pcStats;if(o.captureStats)q.$FBRTCCallSummary24=o.captureStats;if(o.gen0IceSentCount)q.$FBRTCCallSummary8=o.gen0IceSentCount;if(o.gen0IceReceivedCount)q.$FBRTCCallSummary9=o.gen0IceReceivedCount;if(o.iceSentCount)q.$FBRTCCallSummary10=o.iceSentCount;if(o.iceReceivedCount)q.$FBRTCCallSummary11=o.iceReceivedCount;if(o.newSignalingTime)q.$FBRTCCallSummary5=o.newSignalingTime;if(o.accumulatedCallTime)q.$FBRTCCallSummary14=o.accumulatedCallTime;if(o.escStateTimes)q.$FBRTCCallSummary6=o.escStateTimes;if(o.applicationEventTime)q.$FBRTCCallSummary7=o.applicationEventTime;if(o.videoEscTimes)q.$FBRTCCallSummary12=o.videoEscTimes;return q};m.restoreOrInitialize=function(n,o,p,q,r,s){"use strict";__p&&__p();o=String(o);p=String(p);var t=n.retrieveCallSummary(o,p);if(!t){t=new m({peerID:o,callID:p,isCaller:q});if(r){t.onFullMessageReceived({msg:r});t.onOfferAckSent(r)}else t.onCallStarted(s||c("FBRTCLogger").Trigger.UNKNOWN);c("FBRTCLogger").getInstance().logError(o,p,"Missing call summary from storage")}else if(t.$FBRTCCallSummary35){t.$FBRTCCallSummary36=null;t.$FBRTCCallSummary37=null;t.$FBRTCCallSummary38=null;delete t.$FBRTCCallSummary4[i.CALL_ENDED];delete t.$FBRTCCallSummary5[i.CALL_ENDED];t.$FBRTCCallSummary35=null}return t};m.logSavedSummaries=function(n){"use strict";__p&&__p();var o=n.getLoggableSummaries(),p=o.length;if(p<=0)return;var q=c("FBRTCLogger").getInstance(),r=[];for(var s=0;s<p;s++){var t=o[s];q.logEndCallSummary(t);r.push({peerID:t.peerID,callID:t.callID})}n.removeCallSummaries(r);q.logToConsole("Logged pending summaries: "+p)};m.prototype.save=function(n){"use strict";var o=c("performanceNow")(),p=o-this.$FBRTCCallSummary17;if(p>h){this.$FBRTCCallSummary21.logInfo(this.peerID,this.callID,"Summary too old: "+p);return}n.storeCallSummary(this.peerID,this.callID,this);this.$FBRTCCallSummary17=o};m.prototype.getLastUpdatedTime=function(){"use strict";return this.$FBRTCCallSummary15};m.prototype.setLastUpdatedTime=function(n){"use strict";this.$FBRTCCallSummary15=n};m.prototype.getExtraInfo=function(){"use strict";return this.$FBRTCCallSummary20};m.prototype.getCallTrigger=function(){"use strict";return this.$FBRTCCallSummary3};m.prototype.addExtraInfo=function(n,o){"use strict";this.$FBRTCCallSummary20[n]=o;this.$FBRTCCallSummary40()};m.prototype.isCaller=function(){"use strict";return this.$FBRTCCallSummary1};m.prototype.isNetworkReady=function(){"use strict";if(this.$FBRTCCallSummary4[i.NETWORK_READY])return true;else return false};m.prototype.isAnswerReceived=function(){"use strict";if(this.$FBRTCCallSummary4[i.RECV_ANSWER])return true;else return false};m.prototype.onCallStarted=function(n){"use strict";this.$FBRTCCallSummary3=n;this.$FBRTCCallSummary42(i.CALL_STARTED);this.$FBRTCCallSummary40()};m.prototype.onPopupOpened=function(){"use strict";this.$FBRTCCallSummary43(j.POPUP_OPENED);this.$FBRTCCallSummary19++;this.$FBRTCCallSummary40()};m.prototype.onPressedAnswer=function(){"use strict";this.$FBRTCCallSummary43(j.PRESSED_ANSWER);this.$FBRTCCallSummary40()};m.prototype.onMediaRequested=function(){"use strict";this.$FBRTCCallSummary43(j.MEDIA_REQUESTED);this.$FBRTCCallSummary40()};m.prototype.onMediaSucceeded=function(){"use strict";this.$FBRTCCallSummary43(j.MEDIA_SUCCEEDED);this.$FBRTCCallSummary40()};m.prototype.onFellbackToAudio=function(){"use strict";this.$FBRTCCallSummary43(j.FELLBACK_TO_AUDIO);this.$FBRTCCallSummary40()};m.prototype.setTesterRetries=function(n){"use strict";this.$FBRTCCallSummary7[j.TESTER_RETRIES]=n;this.$FBRTCCallSummary40()};m.prototype.setPcStats=function(n){"use strict";this.$FBRTCCallSummary23=n;this.$FBRTCCallSummary40()};m.prototype.setVideoCaptureStats=function(n,o){"use strict";this.$FBRTCCallSummary24={w:n,h:o};this.$FBRTCCallSummary40()};m.prototype.setVideoCaptureConstraints=function(n){"use strict";this.$FBRTCCallSummary24=n;this.$FBRTCCallSummary40()};m.prototype.setUploadLogLevel=function(n){"use strict";this.$FBRTCCallSummary2=n;this.$FBRTCCallSummary40()};m.prototype.getCallType=function(){"use strict";return this.$FBRTCCallSummary30};m.prototype.setCallType=function(n){"use strict";this.$FBRTCCallSummary30=n;this.addExtraInfo("call_type",n);this.$FBRTCCallSummary40()};m.prototype.setVideoDurations=function(n,o){"use strict";this.$FBRTCCallSummary33=n;this.$FBRTCCallSummary34=o;this.$FBRTCCallSummary40()};m.prototype.setScreenDuration=function(n){"use strict";this.addExtraInfo(c("FBRTCLogger").Key.SCREEN_DURATION,n)};m.prototype.setIsUsingMultiway=function(n){"use strict";this.$FBRTCCallSummary26=n;this.$FBRTCCallSummary40()};m.prototype.setConferenceName=function(n){"use strict";this.$FBRTCCallSummary28=n;this.$FBRTCCallSummary40()};m.prototype.setServerInfoData=function(n){"use strict";this.$FBRTCCallSummary31=n;this.$FBRTCCallSummary40()};m.prototype.setActiveConnection=function(n){"use strict";this.$FBRTCCallSummary27=n;this.$FBRTCCallSummary40()};m.prototype.setEscalationP2PCallID=function(n){"use strict";this.$FBRTCCallSummary29=n;this.$FBRTCCallSummary40()};m.prototype.setEscalationConferenceName=function(n){"use strict";this.$FBRTCCallSummary32=n;this.$FBRTCCallSummary40()};m.prototype.onOfferAckSent=function(n){"use strict";this.onMessageSent({type:c("FBRTCConstants").PayloadType.OFFER_ACK,flag:n.flag})};m.prototype.onMessageSent=function(n){"use strict";__p&&__p();var o=n.flag===1;switch(n.type){case c("FBRTCConstants").PayloadType.OFFER:this.$FBRTCCallSummary44(o,i.SENT_OFFER,i.SENT_RETRIED_OFFER);this.$FBRTCCallSummary45(n,this.$FBRTCCallSummary8,this.$FBRTCCallSummary10);break;case c("FBRTCConstants").PayloadType.ANSWER:this.$FBRTCCallSummary44(o,i.SENT_ANSWER,i.SENT_RETRIED_ANSWER);this.$FBRTCCallSummary45(n,this.$FBRTCCallSummary8,this.$FBRTCCallSummary10);break;case c("FBRTCConstants").PayloadType.OK:this.$FBRTCCallSummary42(i.SENT_OK);break;case c("FBRTCConstants").PayloadType.PRANSWER:this.$FBRTCCallSummary42(i.SENT_PRANSWER);break;case c("FBRTCConstants").PayloadType.OFFER_ACK:this.$FBRTCCallSummary44(o,i.SENT_OFFER_ACK,i.SENT_RETRIED_OFFER_ACK);break;case c("FBRTCConstants").PayloadType.ANSWER_ACK:this.$FBRTCCallSummary44(o,i.SENT_ANSWER_ACK,i.SENT_RETRIED_ANSWER_ACK);break;case c("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummary45(n,this.$FBRTCCallSummary8,this.$FBRTCCallSummary10);break;case c("FBRTCConstants").PayloadType.ACK:if(n.ack_type===c("FBRTCConstants").PayloadType.VIDEO_REQUEST)this.$FBRTCCallSummary46(l.SENT_ESC_REQUEST_ACK);break;case c("FBRTCConstants").PayloadType.VIDEO_REQUEST:if(n.ack_id)this.$FBRTCCallSummary46(l.SENT_ESC_RESPONSE);else this.$FBRTCCallSummary46(l.SENT_ESC_REQUEST);break;default:}this.$FBRTCCallSummary40()};m.prototype.$FBRTCCallSummary45=function(n,o,p){"use strict";var q=null,r=null,s=this.$FBRTCCallSummary22.extractIceInfo(n.sdp);for(var t=0;t<s.length;t++){q=s[t].gen;r=s[t].type;if(q===0)this.$FBRTCCallSummary47(o,r);this.$FBRTCCallSummary47(p,r)}};m.prototype.$FBRTCCallSummary47=function(n,o){"use strict";if(!n[o])n[o]=1;else n[o]=n[o]+1};m.prototype.$FBRTCCallSummary48=function(n){"use strict";this.addExtraInfo(c("FBRTCLogger").Key.PEER_IS_MOBILE,n.isFromMobile()?"1":"0")};m.prototype.onFullMessageReceived=function(n){"use strict";__p&&__p();var o=n.msg,p=o.flag===1;switch(o.type){case c("FBRTCConstants").PayloadType.OFFER:this.$FBRTCCallSummary48(n);this.$FBRTCCallSummary44(p,i.RECV_OFFER,i.RECV_RETRIED_OFFER);this.$FBRTCCallSummary45(o,this.$FBRTCCallSummary9,this.$FBRTCCallSummary11);break;case c("FBRTCConstants").PayloadType.ANSWER:this.$FBRTCCallSummary48(n);this.$FBRTCCallSummary44(p,i.RECV_ANSWER,i.RECV_RETRIED_ANSWER);this.$FBRTCCallSummary45(o,this.$FBRTCCallSummary9,this.$FBRTCCallSummary11);break;case c("FBRTCConstants").PayloadType.OK:this.$FBRTCCallSummary42(i.RECV_OK);break;case c("FBRTCConstants").PayloadType.PRANSWER:this.$FBRTCCallSummary42(i.RECV_PRANSWER);break;case c("FBRTCConstants").PayloadType.OFFER_ACK:this.$FBRTCCallSummary44(p,i.RECV_OFFER_ACK,i.RECV_RETRIED_OFFER_ACK);break;case c("FBRTCConstants").PayloadType.ANSWER_ACK:this.$FBRTCCallSummary44(p,i.RECV_ANSWER_ACK,i.RECV_RETRIED_ANSWER_ACK);break;case c("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$FBRTCCallSummary45(o,this.$FBRTCCallSummary9,this.$FBRTCCallSummary11);break;case c("FBRTCConstants").PayloadType.ACK:if(o.ack_type===c("FBRTCConstants").PayloadType.VIDEO_REQUEST)this.$FBRTCCallSummary46(l.RECV_ESC_REQUEST_ACK);break;case c("FBRTCConstants").PayloadType.VIDEO_REQUEST:if(o.ack_id)if(o.videoon||o.reqVideoOn)this.$FBRTCCallSummary46(l.RECV_ESC_ACCEPT);else this.$FBRTCCallSummary46(l.RECV_ESC_DECLINE);else if(o.videoon||o.reqVideoOn)this.$FBRTCCallSummary46(l.RECV_ESC_REQUEST);else this.$FBRTCCallSummary46(l.RECV_ESC_TIMEOUT);default:}this.$FBRTCCallSummary40()};m.prototype.onMsgAckReceived=function(n,o){"use strict";var p=n.msg.flag===1;if(o)this.$FBRTCCallSummary44(p,i.RECV_OFFER_ACK,i.RECV_RETRIED_OFFER_ACK);else this.$FBRTCCallSummary44(p,i.RECV_ANSWER_ACK,i.RECV_RETRIED_ANSWER_ACK)};m.prototype.onNetworkReady=function(){"use strict";this.$FBRTCCallSummary42(i.NETWORK_READY);this.$FBRTCCallSummary40()};m.prototype.onCallConnected=function(){"use strict";this.$FBRTCCallSummary42(i.CALL_CONNECTED);this.$FBRTCCallSummary40()};m.prototype.onCallEnded=function(n,o,p,q){"use strict";this.$FBRTCCallSummary35=p;this.$FBRTCCallSummary36=String(n);this.$FBRTCCallSummary37=q;this.$FBRTCCallSummary38=o;this.$FBRTCCallSummary42(i.CALL_ENDED);this.$FBRTCCallSummary40()};m.prototype.setOfferSentTime=function(){"use strict";this.$FBRTCCallSummary42(i.SENT_OFFER)};m.prototype.setOfferAckReceivedTime=function(){"use strict";this.$FBRTCCallSummary42(i.RECV_OFFER_ACK)};m.prototype.setAnswerSentTime=function(){"use strict";this.$FBRTCCallSummary42(i.SENT_ANSWER)};m.prototype.setAnswerReceivedTime=function(){"use strict";this.$FBRTCCallSummary42(i.RECV_ANSWER)};m.prototype.setEscalationAvailable=function(){"use strict";this.$FBRTCCallSummary49(k.ESCALATION_IS_AVAILABLE)};m.prototype.setEscalationInitiated=function(){"use strict";this.$FBRTCCallSummary49(k.USER_INITIATED_REQUEST)};m.prototype.setReceivedEscalationRequest=function(){"use strict";this.$FBRTCCallSummary49(k.RECEIVED_INCOMING_REQUEST)};m.prototype.setInvalidP2PEscalationState=function(){"use strict";this.$FBRTCCallSummary49(k.REJECTED_INVALID_P2P_STATE)};m.prototype.setEscalationConnectingToMultiway=function(){"use strict";this.$FBRTCCallSummary49(k.CONNECTING_TO_MULTIWAY)};m.prototype.setEscalationConnectedToMultiway=function(){"use strict";this.$FBRTCCallSummary49(k.CONNECTED_TO_MULTIWAY)};m.prototype.setEscalationPeerConnectingToMultiway=function(){"use strict";this.$FBRTCCallSummary49(k.PEER_CONNECTING_TO_MULTIWAY)};m.prototype.setEscalationPeerConnectedToMultiway=function(){"use strict";this.$FBRTCCallSummary49(k.PEER_CONNECTED_TO_MULTIWAY)};m.prototype.setReadyToEscalate=function(){"use strict";this.$FBRTCCallSummary49(k.READY_TO_ESCALATE)};m.prototype.setEscalationPeerFailedToConnectToMultiway=function(){"use strict";this.$FBRTCCallSummary49(k.PEER_FAILED_TO_CONNECT_TO_MULTIWAY)};m.prototype.setEscalationTimedOut=function(){"use strict";this.$FBRTCCallSummary49(k.TIMED_OUT)};m.prototype.setVidEscalationInitClick=function(){"use strict";this.$FBRTCCallSummary46(l.ESCALATION_INITIATION_BUTTON_CLICKED)};m.prototype.setVidEscalationAcceptedClick=function(){"use strict";this.$FBRTCCallSummary46(l.ESCALATION_APPROVED_BUTTON_CLICKED)};m.prototype.setVidEscalationDeclinedClick=function(){"use strict";this.$FBRTCCallSummary46(l.ESCALATION_DECLINED_BUTTON_CLICKED)};m.prototype.setVidEscalationMediaRequested=function(){"use strict";this.$FBRTCCallSummary46(l.USERMEDIA_REQUEST)};m.prototype.setVidEscalationMediaSuccess=function(){"use strict";this.$FBRTCCallSummary46(l.USERMEDIA_SUCCESS)};m.prototype.setVidEscalationMediaFailed=function(){"use strict";this.$FBRTCCallSummary46(l.USERMEDIA_FAILURE)};m.prototype.toString=function(){"use strict";var n={};n.core_metrics=this.$FBRTCCallSummary50();n.time_series=null;return JSON.stringify(n)};m.prototype.$FBRTCCallSummary50=function(){"use strict";__p&&__p();var n={};n.ver=m.CURRENT_SUMMARY_VERSION;n.log_level=c("FBRTCConstants").uploadLogLevelString(this.$FBRTCCallSummary2);n.caller=this.$FBRTCCallSummary1;n.call_type=this.$FBRTCCallSummary30;n.is_using_multiway=this.$FBRTCCallSummary26;n.active_conn=this.$FBRTCCallSummary27;n.app_event_times=this.$FBRTCCallSummary7;n.conf_name=this.$FBRTCCallSummary28;n.esc_p2p_call_id=this.$FBRTCCallSummary29;n.esc_state_times=this.$FBRTCCallSummary6;n.esc_conf_name=this.$FBRTCCallSummary32;n.vid_esc_times=this.$FBRTCCallSummary12;n.serv_info=this.$FBRTCCallSummary31;n.conn=this.$FBRTCCallSummary51();n.peer_id=this.peerID;n.has_video=true;n.open_count=this.$FBRTCCallSummary19;n.signaling=this.$FBRTCCallSummary52();n.sender=this.$FBRTCCallSummary53();n.receiver=this.$FBRTCCallSummary54();n.end=this.$FBRTCCallSummary55();n.video=this.$FBRTCCallSummary56();n.push_phase=c("SiteData").push_phase;n.client_version=this.$FBRTCCallSummary25;return n};m.prototype.$FBRTCCallSummary51=function(){"use strict";var n={dtls:1};if(this.$FBRTCCallSummary23.sender&&this.$FBRTCCallSummary23.sender.rtt)n.rtt=this.$FBRTCCallSummary23.sender.rtt;return n};m.prototype.$FBRTCCallSummary52=function(){"use strict";__p&&__p();var n={};if(this.$FBRTCCallSummary3)n.trigger=this.$FBRTCCallSummary3;n.start_time=this.$FBRTCCallSummary13;n.time_from_start=this.$FBRTCCallSummary4;var o=this.$FBRTCCallSummary4[i.CALL_CONNECTED],p=this.$FBRTCCallSummary4[i.CALL_ENDED];if(o){if(!p)if(this.$FBRTCCallSummary16)p=this.$FBRTCCallSummary16-this.$FBRTCCallSummary13;else p=this.$FBRTCCallSummary57();var q=p-o;if(q>0)n.duration=q}n.new_time_from_start=this.$FBRTCCallSummary5;o=this.$FBRTCCallSummary5[i.CALL_CONNECTED];p=this.$FBRTCCallSummary5[i.CALL_ENDED];if(o){if(!p)if(this.$FBRTCCallSummary14>0)p=this.$FBRTCCallSummary14;else p=this.$FBRTCCallSummary41();var r=p-o;if(r>0)n.new_duration=r}return n};m.prototype.$FBRTCCallSummary53=function(){"use strict";var n={};if(this.$FBRTCCallSummary8)n.ice_g0=this.$FBRTCCallSummary8;if(this.$FBRTCCallSummary10)n.ice=this.$FBRTCCallSummary10;if(this.$FBRTCCallSummary23.sender)Object.assign(n,this.$FBRTCCallSummary23.sender);return n};m.prototype.$FBRTCCallSummary54=function(){"use strict";var n={};if(this.$FBRTCCallSummary9)n.ice_g0=this.$FBRTCCallSummary9;if(this.$FBRTCCallSummary11)n.ice=this.$FBRTCCallSummary11;return n};m.prototype.$FBRTCCallSummary55=function(){"use strict";__p&&__p();var n={};if(this.$FBRTCCallSummary36!==null){n.end_call_reason_string=c("FBRTCConstants").callEndReasonString(this.$FBRTCCallSummary36);if(this.$FBRTCCallSummary37!==null)n.end_call_subreason_string=this.$FBRTCCallSummary37;n.remote_ended=this.$FBRTCCallSummary38}if(this.$FBRTCCallSummary23.end)Object.assign(n,this.$FBRTCCallSummary23.end);return n};m.prototype.$FBRTCCallSummary56=function(){"use strict";var n={capture:{}};if(this.$FBRTCCallSummary23.video&&this.$FBRTCCallSummary23.video.sender)Object.assign(n,this.$FBRTCCallSummary23.video.sender);if(this.$FBRTCCallSummary24)Object.assign(n.capture,this.$FBRTCCallSummary24);return{sender:n,ld:this.$FBRTCCallSummary33,rd:this.$FBRTCCallSummary34}};m.prototype.$FBRTCCallSummary57=function(){"use strict";return new Date().valueOf()-this.$FBRTCCallSummary13};m.prototype.$FBRTCCallSummary41=function(){"use strict";var n=c("performanceNow")()-this.$FBRTCCallSummary18;return Math.floor(this.$FBRTCCallSummary14+n)};m.prototype.$FBRTCCallSummary42=function(n){"use strict";if(this.$FBRTCCallSummary4[n])return;this.$FBRTCCallSummary4[n]=this.$FBRTCCallSummary57();this.$FBRTCCallSummary5[n]=this.$FBRTCCallSummary41()};m.prototype.$FBRTCCallSummary49=function(n){"use strict";if(this.$FBRTCCallSummary6[n])return;this.$FBRTCCallSummary6[n]=this.$FBRTCCallSummary57()};m.prototype.$FBRTCCallSummary43=function(event){"use strict";if(this.$FBRTCCallSummary7[event])return;this.$FBRTCCallSummary7[event]=this.$FBRTCCallSummary57()};m.prototype.$FBRTCCallSummary46=function(event){"use strict";if(this.$FBRTCCallSummary12[event])return;this.$FBRTCCallSummary12[event]=this.$FBRTCCallSummary57()};m.prototype.$FBRTCCallSummary44=function(n,o,p){"use strict";if(n)this.$FBRTCCallSummary42(p);else this.$FBRTCCallSummary42(o)};m.prototype.$FBRTCCallSummary40=function(){"use strict";this.$FBRTCCallSummary15=new Date().valueOf()};m.prototype.$FBRTCCallSummary39=function(){"use strict";return{device:c("UserAgentData").deviceName,os:c("UserAgentData").platformName,os_version:c("UserAgentData").platformFullVersion,browser:c("UserAgentData").browserName,browser_version:c("UserAgentData").browserFullVersion,screen_height:window.screen.availHeight,screen_width:window.screen.availWidth}};m.prototype.setClientVersion=function(n){"use strict";this.$FBRTCCallSummary25=n};m.prototype.getCallDuration=function(){"use strict";var n=this.$FBRTCCallSummary52();return n.duration?n.duration:0};m.prototype.getConnectedStartTime=function(){"use strict";return this.$FBRTCCallSummary4[i.CALL_CONNECTED]?this.$FBRTCCallSummary4[i.CALL_CONNECTED]+this.$FBRTCCallSummary13:0};m.CURRENT_SUMMARY_VERSION=19;f.exports=m}),null);
__d("FBRTCCallSummaryStore",["CacheStorage","FBRTCCallSummary","FBRTCLogger","areEqual"],(function a(b,c,d,e,f,g){__p&&__p();var h="localstorage",i="RTC_CALL_SUMMARY_",j="summary",k=2e3,l=3,m=3*60*1e3,n=null;o.getInstance=function(){"use strict";if(!n)n=new o();return n};function o(){"use strict";this.$FBRTCCallSummaryStore1=new(c("CacheStorage"))(h,i);this.$FBRTCCallSummaryStore2=c("FBRTCLogger").getInstance()}o.prototype.storeCallSummary=function(p,q,r){"use strict";__p&&__p();var s=this;this.$FBRTCCallSummaryStore3(function(t){__p&&__p();if(!t[p])t[p]={};var u=t[p][q];if(u){var v=s.$FBRTCCallSummaryStore4(u);if(v&&v.getLastUpdatedTime()>r.getLastUpdatedTime()){s.$FBRTCCallSummaryStore2.logToConsole("Outdated summaries");return null}}t[p][q]=s.$FBRTCCallSummaryStore5(r);return t},s.$FBRTCCallSummaryStore2.logError.bind(s.$FBRTCCallSummaryStore2,p,q))};o.prototype.retrieveCallSummary=function(p,q){"use strict";var r=this.$FBRTCCallSummaryStore6(),s=null;if(r[p])s=r[p][q];if(s)return this.$FBRTCCallSummaryStore4(s);else return null};o.prototype.removeCallSummary=function(p,q){"use strict";this.removeCallSummaries([{peerID:p,callID:q}])};o.prototype.removeCallSummaries=function(p){"use strict";__p&&__p();var q=this;this.$FBRTCCallSummaryStore3(function(r){__p&&__p();var s=p.length;for(var t=0;t<s;t++){var u=p[t].peerID,v=p[t].callID;if(r[u]&&r[u][v]){delete r[u][v];if(q.$FBRTCCallSummaryStore7(r[u]))delete r[u]}}return r},q.$FBRTCCallSummaryStore2.logError.bind(q.$FBRTCCallSummaryStore2,null,null))};o.prototype.getLoggableSummaries=function(){"use strict";__p&&__p();var p=this.$FBRTCCallSummaryStore6(),q=[];for(var r in p)if(Object.prototype.hasOwnProperty.call(p,r))for(var s in p[r])if(Object.prototype.hasOwnProperty.call(p[r],s)){var t=this.$FBRTCCallSummaryStore4(p[r][s],m);if(t)q.push(t)}return q};o.prototype.$FBRTCCallSummaryStore7=function(p){"use strict";for(var q in p)if(Object.prototype.hasOwnProperty.call(p,q))return false;return true};o.prototype.$FBRTCCallSummaryStore5=function(p){"use strict";var q={__t:Date.now(),__d:p.toJsonString()};return q};o.prototype.$FBRTCCallSummaryStore4=function(p,q){"use strict";if(p)if(!q||Date.now()-p.__t>=q)return c("FBRTCCallSummary").fromJsonString(p.__d);return null};o.prototype.$FBRTCCallSummaryStore6=function(){"use strict";var p=this.$FBRTCCallSummaryStore1.get(j)||{};return p};o.prototype.$FBRTCCallSummaryStore3=function(p,q,r,s){__p&&__p();var t,u=this;"use strict";if(r===undefined||r===null)r=l;var v=this.$FBRTCCallSummaryStore6(),w=this.$FBRTCCallSummaryStore6(),x=p(v);if(x===null)return;var y=this.$FBRTCCallSummaryStore6();if(c("areEqual")(w,y)){this.$FBRTCCallSummaryStore1.set(j,x);this.$FBRTCCallSummaryStore2.logToConsole("Updated summaries")}else if(r>0){q("Retry lock");if(s)(function(){var z=u;setTimeout(function(){z.$FBRTCCallSummaryStore3(p,q,r-1,true)},k)})();else this.$FBRTCCallSummaryStore3(p,q,r-1,true)}else q("Failed to lock")};f.exports=o}),null);
__d("FBRTCCallSummaryUploader",["Banzai","FBRTCCallSummary","FBRTCCallSummaryStore"],(function a(b,c,d,e,f,g){var h={init:function i(){var j=c("FBRTCCallSummaryStore").getInstance();c("Banzai").subscribe(c("Banzai").SEND,function(){c("FBRTCCallSummary").logSavedSummaries(j)})}};f.exports=h}),null);
__d("NotificationJewelReminderLoader",[],(function a(b,c,d,e,f,g){f.exports={init:function h(i,j){i.load().done(function(k){k.init(j)})}}}),null);
__d("P2PDialogStore",["EventEmitter","P2PActionConstants","P2PDispatcher"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=void 0,k={};h=babelHelpers.inherits(l,c("EventEmitter"));i=h&&h.prototype;function l(){i.constructor.call(this);j=c("P2PDispatcher").register(this.onEventDispatched.bind(this));k={dialogClass:null,dialogProps:null}}l.prototype.getState=function(){return k};l.prototype.onEventDispatched=function(m){__p&&__p();var n=m.type,o=m.data;switch(n){case c("P2PActionConstants").DIALOG_SHOWN:k.dialogClass=o.dialogClass;k.dialogProps=o.dialogProps;this.emit("change");break;case c("P2PActionConstants").DIALOG_CLOSED:k.dialogClass=null;k.dialogProps=null;this.emit("change");break}};f.exports=new l()}),null);
__d("P2PDialogContainer.react",["P2PDialogStore","React"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i;h=babelHelpers.inherits(j,c("React").Component);i=h&&h.prototype;function j(){var k,l;for(var m=arguments.length,n=Array(m),o=0;o<m;o++)n[o]=arguments[o];return l=(k=i.constructor).call.apply(k,[this].concat(n)),this.state=c("P2PDialogStore").getState(),this.onDialogStoreChange=function(){this.setState(c("P2PDialogStore").getState())}.bind(this),l}j.prototype.componentDidMount=function(){this.dialogStoreSub=c("P2PDialogStore").addListener("change",this.onDialogStoreChange)};j.prototype.componentWillUnmount=function(){if(this.dialogStoreSub){this.dialogStoreSub.remove();this.dialogStoreSub=null}};j.prototype.render=function(){if(!this.state.dialogClass)return null;var k=this.state.dialogClass;return c("React").createElement(k,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))};f.exports=j}),null);
__d("P2PDialogContainerMount",["P2PDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("P2PDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("PagesPlatformActionConstants",[],(function a(b,c,d,e,f,g){"use strict";var h=Object.freeze({BOOKING_REQUEST_ACCEPT_ERROR:"booking_request_accept_error",BOOKING_REQUEST_ACCEPT_INITIATED:"booking_request_accept_initiated",BOOKING_REQUEST_ACCEPTED:"booking_request_accepted",BOOKING_REQUEST_CREATED:"booking_request_created",BOOKING_REQUEST_DECLINE_ERROR:"booking_request_decline_error",BOOKING_REQUEST_DECLINE_INITIATED:"booking_request_decline_initiated",BOOKING_REQUEST_DECLINED:"booking_request_declined",BOOKING_REQUEST_RESCHEDULE_INITIATED:"booking_request_reschedule_initiated",BOOKING_REQUEST_RESCHEULED:"booking_request_reschedule",DIALOG_CLOSED:"dialog_closed",DIALOG_SHOWN:"dialog_shown",NEW_TIME_CHOSEN:"new_time_chosen"});f.exports=h}),null);
__d("PagesPlatformRequestDispatcher",["Dispatcher_DEPRECATED"],(function a(b,c,d,e,f,g){"use strict";f.exports=new(c("Dispatcher_DEPRECATED"))()}),null);
__d("PagesPlatformDialogStore",["EventEmitter","PagesPlatformActionConstants","PagesPlatformRequestDispatcher"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j={};h=babelHelpers.inherits(k,c("EventEmitter"));i=h&&h.prototype;function k(){i.constructor.call(this);c("PagesPlatformRequestDispatcher").register(this.onEventDispatched.bind(this));j={dialogClass:null,dialogProps:null}}k.prototype.getState=function(){return j};k.prototype.onEventDispatched=function(l){__p&&__p();var m=l.type,n=l.data;switch(m){case c("PagesPlatformActionConstants").DIALOG_SHOWN:j.dialogClass=n.dialogClass;j.dialogProps=n.dialogProps;this.emit("change");break;case c("PagesPlatformActionConstants").DIALOG_CLOSED:j.dialogClass=null;j.dialogProps=null;this.emit("change");break}};f.exports=new k()}),null);
__d("PagesPlatformDialogContainer.react",["PagesPlatformDialogStore","PureStoreBasedStateMixin","React"],(function a(b,c,d,e,f,g){"use strict";var h=c("React").createClass({displayName:"PagesPlatformDialogContainer",mixins:[c("PureStoreBasedStateMixin")(c("PagesPlatformDialogStore"))],statics:{calculateState:function i(){return c("PagesPlatformDialogStore").getState()}},render:function i(){if(!this.state.dialogClass)return null;var j=this.state.dialogClass;return c("React").createElement(j,babelHelpers["extends"]({},this.state.dialogProps,{key:"dialog"}))}});f.exports=h}),null);
__d("PagesPlatformDialogContainerMount",["PagesPlatformDialogContainer.react","React","ReactDOM"],(function a(b,c,d,e,f,g){"use strict";var h={mount:function i(j){c("ReactDOM").render(c("React").createElement(c("PagesPlatformDialogContainer.react"),null),j)}};f.exports=h}),null);
__d("LiveMessageReceiver",["Arbiter","ChannelConstants","emptyFunction","shield"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){this.eventName=i;this.subs=null;this.handler=c("emptyFunction");this.shutdownHandler=null;this.registered=false;this.appId=1}Object.assign(h,{getAppMessageType:function i(j,k){return"live_message/"+j+":"+k},route:function i(j){var k=function k(l){var m=h.getAppMessageType(j.app_id,j.event_name);c("Arbiter").inform(m,l,c("Arbiter").BEHAVIOR_PERSISTENT)};k(j.response)}});Object.assign(h.prototype,{setAppId:function i(j){this.appId=j;return this},setHandler:function i(j){this.handler=j;this._dirty();return this},setRestartHandler:c("emptyFunction"),setShutdownHandler:function i(j){this.shutdownHandler=c("shield")(j);this._dirty();return this},_dirty:function i(){if(this.registered){this.unregister();this.register()}},register:function i(){var j=function(k,l){return this.handler(l)}.bind(this),k=h.getAppMessageType(this.appId,this.eventName);this.subs={};this.subs.main=c("Arbiter").subscribe(k,j);if(this.shutdownHandler)this.subs.shut=c("Arbiter").subscribe(c("ChannelConstants").ON_SHUTDOWN,this.shutdownHandler);this.registered=true;return this},unregister:function i(){if(!this.subs)return this;for(var j in this.subs)if(this.subs[j])this.subs[j].unsubscribe();this.subs=null;this.registered=false;return this}});f.exports=h}),null);
__d("initLiveMessageReceiver",["Arbiter","ChannelConstants","LiveMessageReceiver"],(function a(b,c,d,e,f,g){c("Arbiter").subscribe(c("ChannelConstants").getArbiterType("app_msg"),function(h,i){c("LiveMessageReceiver").route(i.obj)})}),null);